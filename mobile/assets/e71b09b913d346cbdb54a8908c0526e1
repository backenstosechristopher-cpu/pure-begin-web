(function( blueConic, undefined ) {var ps='https://plugins.blueconic.net/';var pf='/gallery/';(function(){var a=false,b=/xyz/.test(function(){xyz})?/\b_super\b/:/.*/;this.BCClass=function(){};BCClass.extend=function(g){var f=this.prototype;a=true;var e=new this();a=false;for(var d in g){e[d]=typeof g[d]=="function"&&typeof f[d]=="function"&&b.test(g[d])?(function(h,i){return function(){var k=this._super;this._super=f[h];var j=i.apply(this,arguments);this._super=k;return j}})(d,g[d]):g[d]}function c(){if(!a&&this.init){this.init.apply(this,arguments)}}c.prototype=e;c.constructor=c;c.extend=arguments.callee;return c}})();var InteractionType=BCClass.extend({init:function(a){},getPreloadProperties:function(){return[]},getContent:function(){},onEvent:function(){},importLibraries:function(c){var e=[];var a=[];if(!c||c.length===0){return}for(var b=0;b<c.length;b++){var d=c[b];if(d&&d.sharing==="none"){e.push(d.url)}else{a.push(d.url)}}blueConic.fn.importLibraries.call(this,e);blueConic.fn.importAndCacheLibraries.call(this,a)}});(function(){ var EVENT_SHOPPING_CART="shoppingcart",EVENT_ORDER="order",EVENT_PRODUCT_VIEW="product_view",SUBSCRIBED_TO_EVENT=[],InteractionTypeImpl=InteractionType.extend({init:function(t,e){this.blueConicClient=t,this.context=e,this.profile=this.context.getProfile(),this.parameters=this.context.getParameters(),this.lastCartUpdateProperty=this.getParameterValue("lastCartUpdateProperty"),this.nrProductsInCartProperty=this.getParameterValue("nrProductsInCartProperty"),this.storeId=this.getParameterValue("storeId"),this._subscribeToShoppingEvents()},getParameterValue:function(t){return this.parameters&&this.parameters[t]&&this.parameters[t][0]?this.parameters[t][0]:null},_subscribeToShoppingEvents:function(){-1===SUBSCRIBED_TO_EVENT.indexOf(EVENT_SHOPPING_CART)&&this.blueConicClient.event.subscribe(EVENT_SHOPPING_CART,this,this._handleShoppingCartEvent),-1===SUBSCRIBED_TO_EVENT.indexOf(EVENT_ORDER)&&this.blueConicClient.event.subscribe(EVENT_ORDER,this,this._handleOrderEvent),-1===SUBSCRIBED_TO_EVENT.indexOf(EVENT_PRODUCT_VIEW)&&this.blueConicClient.event.subscribe(EVENT_PRODUCT_VIEW,this,this._handleProductView),SUBSCRIBED_TO_EVENT=[EVENT_SHOPPING_CART,EVENT_ORDER,EVENT_PRODUCT_VIEW]},_getProductIds:function(t){if(t&&t.productIds&&(!t.storeId||t.storeId===this.storeId))return this.blueConicClient.util.array.ensureArray(t.productIds)},_handleShoppingCartEvent:function(t,e){var r=this._getProductIds(e);r&&this._updateShoppingcartItems(r)},_handleOrderEvent:function(t,e){var r=this._getProductIds(e);r&&(this._updateBoughtItems(r),this._updateShoppingcartItems([]))},_updateShoppingcartItems:function(t){this.blueConicClient.recommendation.createEvent({storeId:this.storeId,action:EVENT_SHOPPING_CART,itemId:t,profileId:this.profile.getId(),queue:!1}),this.nrProductsInCartProperty&&this._storeItemsInShoppingCart(t),this.lastCartUpdateProperty&&this._storeCurrentDateAsLastCartUpdate(),(this.nrProductsInCartProperty||this.lastCartUpdateProperty)&&this.blueConicClient.profile.updateProfile()},_storeItemsInShoppingCart:function(t){this.profile.setValue(this.nrProductsInCartProperty,t.length)},_storeCurrentDateAsLastCartUpdate:function(){this.profile.setValue(this.lastCartUpdateProperty,this.blueConicClient.getCurrentDate().getTime())},_updateBoughtItems:function(t){this.blueConicClient.recommendation.createEvent({storeId:this.storeId,action:EVENT_ORDER,itemId:t,profileId:this.profile.getId(),queue:!1})},_handleProductView:function(t,e){if(e&&e.productIds&&(!e.storeId||e.storeId===this.storeId)){this.referrer=document.referrer;var r=document.referrer.replace(/http[s]?:\/\/(.*?)(:|\?|\/|$).*/,"$1"),i=window.location.hostname;this.blueConicClient.recommendation.createEvent({storeId:e.storeId?e.storeId:this.storeId,action:"view",itemId:e.productIds[0],profileId:this.profile.getId(),isEntrypage:r!==i,queue:!1})}}});var a = [];var i='connection_product_collector_sftp';blueConic.fn.registerInteractionType(i, InteractionTypeImpl, a, [{ id : i, baseUrl : blueConic.fn.getBCHostnameAwarePluginsRepositoryUrl(ps, pf) + i + '/1.4.1/'}]);})();(function(){ var InteractionTypeImpl=InteractionType.extend({init:function(a,b){this.blueConicClient=a,this.context=b,this.profile=this.blueConicClient.profile.getProfile(),this.parameters=this.context.getParameters(),this.consentEvent=this.parameters.consentEvent?this.parameters.consentEvent[0]:null,this.cookieConsentName=this.parameters.cookieConsentName?this.parameters.cookieConsentName[0]:null,this.cookieRefuseName=this.parameters.cookieRefuseName?this.parameters.cookieRefuseName[0]:null,this.baseObjectiveName=this.parameters.cookieBaseName+""?this.parameters.cookieBaseName[0]:null,this.TIMESTAMP_PROPERTY="timestamp_objectives",this.HOSTNAME_PROPERTY="hostname_objectives"},getPreloadProperties:function(){return[this.TIMESTAMP_PROPERTY,this.HOSTNAME_PROPERTY]},onLoad:function(){this.profile&&this.baseObjectiveName&&-1===this.profile.getConsentedObjectives().indexOf(this.baseObjectiveName)&&(this.profile.addConsentedObjective(this.baseObjectiveName),this.blueConicClient.profile.updateProfile(this,this._writeCookie(!0))),this._subscribeToConsentEvent(),this._writeCookie(!1)},_writeCookie:function(a){var b=[],c=[];if(this.profile){b=this.profile.getConsentedObjectives(),c=this.profile.getRefusedObjectives();var d=365;this.cookieConsentName?this._setCookie(this.cookieConsentName,b,d):this.blueConicClient.util.log("Cookie Consent Name not available",this),this.cookieRefuseName?this._setCookie(this.cookieRefuseName,c,d):this.blueConicClient.util.log("Cookie Refuse Name not available",this),a&&(this._addTimeStamp(),this._addHostName())}else this.blueConicClient.util.log("BlueConic profile is not available",this)},_subscribeToConsentEvent:function(){this.consentEvent&&this.blueConicClient.event.subscribe(this.consentEvent,this,(a)=>{a.toLowerCase()===this.consentEvent.toLowerCase()&&this._writeCookie(!0)})},_setCookie:function(a,b,c){var d="";b&&b.forEach((a,c)=>{d+=a,c===b.length||(d+="|")});var e=new Date;e.setTime(e.getTime()+864E5*c),c="expires="+e.toUTCString(),document.cookie=a+"="+d+";"+c+";path=/"},_addTimeStamp:function(){var a=new Date;this.profile.setValue(this.TIMESTAMP_PROPERTY,a)},_addHostName:function(){var a=document.location.hostname;this.profile.setValue(this.HOSTNAME_PROPERTY,a)}});var a = [];var i='consentlistener';a.push({url: 'http://code.jquery.com/jquery-1.11.2.min.js', sharing: 'local'});blueConic.fn.registerInteractionType(i, InteractionTypeImpl, a, [{ id : i, baseUrl : blueConic.fn.getBCHostnameAwareLocalPluginsUrl() + '/plugins/consentlistener/ts_bbe07ce3024c996cdcadb561bd4a5305/'}]);})();(function(){ var contentSpecial={html:{nl:{content:'<div class="bcCSContent">Plaats hier uw content</div>'},default:{content:'<div class="bcCSContent">Place your content here</div>'}},init:function(t,e){this.blueConicClient=t,this.context=e||null,this.profile=t.profile.getProfile(),this.element=this.context.getDOMElement(),this.identifier="bc_"+this.context.getInteractionId(),this.parameters=this.context.getParameters(),this.currentInsertType=this.parameters.inserttype&&this.parameters.inserttype[0]?this.parameters.inserttype[0]:"replace","replacecontainer"!==this.currentInsertType||document.getElementById(this.identifier)||this._hidePosition();var i=this.parameters.content+"";this.htmlFragment=this._createElement(i);try{this.htmlFragment&&this.htmlFragment.childNodes&&Array.from(this.htmlFragment.childNodes).forEach(function(t){t.nodeType===window.Node.ELEMENT_NODE&&t.classList.add("bcContentDialogue")})}catch(t){console.error("Error adding class to child nodes: ",t)}this._lastEvent=null,this._inlineCss=null,this._lastCheckDate=null,this._timeoutID=null},getPreloadProperties:function(){return this.htmlFragment?this._getPropertiesFromPlaceholders(this.htmlFragment.innerHTML):[]},getContent:function(){return this._handleStyling(),this.htmlFragment?(this.element||(this.element=this.context.getDOMElement()),"replace"===this.currentInsertType?(this._emptyElementsWithAttribute(this.htmlFragment,"div","data-bc-external"),this.htmlFragment.innerHTML):void 0):null},onUpdate:function(){this.currentInsertType!==this.context.getParameters().inserttype[0]&&document.location.reload()},onLoad:function(){window.bc=window.bc||{},window.bc.jQuery=this.jQuery,window.bc.$=this.jQuery,this.currentInsertType&&this._placeContent(),this.blueConicClient.isInEditMode()&&this.blueConicClient.event.publish("contentinteractiontypespecial.interactionLoaded",{interaction:this})},onMessageReceived:function(t){this.blueConicClient.event.publish("contentinteractiontypespecial.messageReceived",t)},_hidePosition:function(){this.styleIdentifier="bcCS"+this.context.getInteractionId();var t=this.context.getPosition()+" {opacity: 0 !important}",e=document.getElementsByTagName("head")[0]||document.getElementsByTagName("body")[0],i=document.createElement("style");i.type="text/css",i.id=this.styleIdentifier,i.styleSheet?i.styleSheet.cssText=t:i.innerHTML=t,e.appendChild(i)},_showPosition:function(){this.jQuery("#"+this.styleIdentifier).remove()},_placeContent:function(){var t=this.element||this.context.getDOMElement();if(t&&(this._handleStyling(),this.blueConicClient.isInEditMode()||this._handleURLs(this.htmlFragment),"replace"!==this.currentInsertType?this.htmlFragment&&(this._emptyElementsWithAttribute(this.htmlFragment,"div","data-bc-external"),this._setContent()):this._replaceContent(t),!this.blueConicClient.isInEditMode())){var e=this.parameters.clickselector&&this.parameters.clickselector[0]?this.parameters.clickselector[0]:"";if(e){this.jQuery("body").one("click",e,function(t){this._lastEvent&&this._lastEvent.originalEvent===t.originalEvent||this._logClickEvent(t)}.bind(this));try{this.jQuery(e).one("click",function(t){this.lastEvent=t,this._logClickEvent(t)}.bind(this))}catch(t){}}!!this.parameters.forceclick&&("true"===this.parameters.forceclick[0]||!0===this.parameters.forceclick[0])&&this.blueConicClient.createEvent("CLICK",this.context.getInteractionId());var i=this.parameters.javascript&&this.parameters.javascript[0]?this.parameters.javascript[0]:"";if(i)try{i=i.replace(/(^|\W)blueConicVariantId(\W|$)/g,'$1"'+this.context.getInteractionId()+'"$2'),this.jQuery("<script>"+i+"<\/script>").appendTo(this.jQuery("body"))}catch(t){console.error(t)}}},_replaceContent:function(t){this._assureVisibilty(t);var e=this.getContent();if(e){var i=t.nodeName?t.nodeName.toLowerCase():t.nodeName;if(-1===this.blueConicClient.util.array.indexOfArray(["area","base","br","col","command","embed","hr","img","input","keygen","link","meta","param","source","track","wbr"],i))if(this.blueConicClient.isInEditMode&&this.blueConicClient.isInEditMode())t.innerHTML!==e&&(t.innerHTML=e);else try{this.jQuery(t).html(e)}catch(t){console.error(t)}else if(t.parentNode){var n=t.parentNode.innerHTML,r=document.createElement("div");r.appendChild(t.cloneNode(!0));var s=r.innerHTML,o=n.replace(s,e);t.parentNode.innerHTML!==o&&(t.parentNode.innerHTML=o)}this._handleComplexObjects(t),this._trackView(t)}},_setContent:function(){var t=this._getElementByPosition(this.context.getPosition());if(t){var e=t.parent().get(0),i=this.jQuery('[data-bc-id="'+this.identifier+'"],#'+this.identifier);if(i.length>0)return this.blueConicClient.isInEditMode&&this.blueConicClient.isInEditMode()?null:(i.replaceWith(this.htmlFragment.innerHTML),this._handleComplexObjects(e),void("prepend"===this.currentInsertType?(t.prev().attr("data-bc-id",this.identifier),this._trackView(t.prev().get(0))):"append"===this.currentInsertType&&(t.next().attr("data-bc-id",this.identifier),this._trackView(t.next().get(0)))));if("prepend"===this.currentInsertType){var n=t.prev();if(n.length>0&&n.attr("data-bc-id")===this.identifier)return;if(this.blueConicClient.isInEditMode&&this.blueConicClient.isInEditMode())t.get(0).parentNode.insertBefore(this.htmlFragment,t.get(0)),this.blueConicClient.functions.setEditableNode("#bc_"+this.context.getInteractionId(),{positionName:"prepend",lockPosition:!0,redrawPosition:!0});else{try{t.before(this.htmlFragment.innerHTML)}catch(t){console.error(t)}var r=t.prev();r.attr("data-bc-id",this.identifier),this._trackView(r.get(0))}}if("append"===this.currentInsertType){var s=t.next();if(s.length>0&&s.attr("data-bc-id")===this.identifier)return;if(this.blueConicClient.isInEditMode&&this.blueConicClient.isInEditMode())t.get(0).parentNode.insertBefore(this.htmlFragment,t.get(0).nextSibling),this.blueConicClient.functions.setEditableNode("#bc_"+this.context.getInteractionId(),{positionName:"append",lockPosition:!0,redrawPosition:!0});else{try{t.after(this.htmlFragment.innerHTML)}catch(t){console.error(t)}var o=t.next();o.attr("data-bc-id",this.identifier),this._trackView(o.get(0))}}if("replacecontainer"===this.currentInsertType){if(this.blueConicClient.isInEditMode&&this.blueConicClient.isInEditMode())t.get(0).parentNode.replaceChild(this.htmlFragment,t.get(0)),this.blueConicClient.functions.setEditableNode("#bc_"+this.context.getInteractionId(),{positionName:"replace container",lockPosition:!0,redrawPosition:!0});else{var a=this.jQuery(this.htmlFragment.innerHTML).replaceAll(t);this._trackView(a.get(0))}this._showPosition()}this.blueConicClient.isInEditMode()&&null===this.context.getInteractionId()&&setTimeout(function(){window.blueConicClient.fn.postMessage("onOpenEditMode",window.blueConicClient.positionHandlers[0])},500),this._handleComplexObjects(e)}},_trackView:function(t){this.blueConicClient.isInEditMode()||(!(!this.parameters.trackviewwhenvisible||!this.parameters.trackviewwhenvisible[0])&&"true"===this.parameters.trackviewwhenvisible[0]?this._isVisible(t)?this.blueConicClient.createEvent("VIEW",this.context.getInteractionId()):(this._lastCheckDate=(new Date).getTime(),this.jQuery(document).on("scroll.bcCSP"+this.identifier,function(){this._checkVisibility(t)}.bind(this)),this.jQuery(window).on("resize.bcCSP"+this.identifier,function(){this._checkVisibility(t)}.bind(this)),this._checkVisibility(t)):this.blueConicClient.createEvent("VIEW",this.context.getInteractionId()))},_checkVisibility:function(t){if((new Date).getTime()-this._lastCheckDate>=500&&(this._lastCheckDate=(new Date).getTime(),this._isVisible(t)))return this.blueConicClient.createEvent("VIEW",this.context.getInteractionId()),this.jQuery(document).off("scroll.bcCSP"+this.identifier),this.jQuery(window).off("resize.bcCSP"+this.identifier),void clearTimeout(this._timeoutID);clearTimeout(this._timeoutID),this._timeoutID=setTimeout(function(){this._checkVisibility(t)}.bind(this),1500)},_isVisible:function(t){var e=t.getBoundingClientRect();return e.top>=0&&e.top<window.innerHeight&&this.jQuery(t).is(":visible")},_logClickEvent:function(t){t&&t.originalEvent&&t.originalEvent._blueConicLoggedClickEvent===this.context.getInteractionId()||(t&&t.target&&t.target.pathname&&t.target.hostname&&0===t.target.pathname.indexOf("/s/")&&-1!==t.target.hostname.indexOf("blueconic")||(t.originalEvent&&(t.originalEvent._blueConicLoggedClickEvent=this.context.getInteractionId()),this.blueConicClient.createEvent("CLICK",this.context.getInteractionId())))},_getElementByPosition:function(t){var e=document.getElementById(t);return e=e?this.jQuery(e):this.jQuery(t)},_createElement:function(t){var e;if(!t){if(!this.blueConicClient.isInEditMode()||"prepend"!==this.currentInsertType&&"append"!==this.currentInsertType)return null;var i="nl"===this.context.getLocale()?"nl":"default";t=this.html[i].content}try{(e=document.createElement("div")).id=this.identifier,e.innerHTML=t}catch(t){return null}return e},_handleURLs:function(t){if(!(!this.parameters.newwindow||!this.parameters.newwindow[0])&&"true"===this.parameters.newwindow[0])for(var e=t.getElementsByTagName("a"),i=0,n=e.length;i<n;i++){var r=e[i];r.getAttribute("target")||r.setAttribute("target","_blank")}this._handlePlaceholders(t)},_assureVisibilty:function(t){this.blueConicClient.isInEditMode&&this.blueConicClient.isInEditMode()&&(t.style.minWidth="10px",t.style.minHeight="10px")},_handlePlaceholders:function(t){for(var e=this._getPropertiesFromPlaceholders(t.innerHTML),i=0;i<e.length;i++){var n=e[i],r=this.profile.getValue(n)||"",s=new RegExp("\\$\\{"+n+"\\}","g");t.innerHTML=t.innerHTML.replace(s,encodeURI(r))}},_getPropertiesFromPlaceholders:function(t){for(var e,i=/\$\{([a-zA-Z\-_0-9]+)\}/g,n=[];null!==(e=i.exec(t));)n.push(e[1]);for(var r=/data-bc-preload="([^"]*)"/g,s=[];null!==(e=r.exec(t));)for(var o=e[1].split(","),a=0;a<o.length;a++)s.push(o[a]);return n.concat(s)},_emptyElementsWithAttribute:function(t,e,i){for(var n=this.getElementsWithAttribute(t,e,i),r=0,s=n.length;r<s;r++){n[r].innerHTML=""}},getElementsWithAttribute:function(t,e,i){for(var n=[],r=t.getElementsByTagName(e),s=0,o=r.length;s<o;s++){var a=r[s];a.getAttribute(i)&&n.push(a)}return n},_handleComplexObjects:function(t){for(var e=this.getElementsWithAttribute(t,"div","data-bc-pluginid"),i=0;i<e.length;i++){var n=e[i],r=n.getAttribute("data-bc-pluginid"),s=n.getAttribute("data-bc-config");if(s)try{var o=s.replace(/\n/g,"\\\\n").replace(/\r/g,"\\\\r").replace(/\t/g,"\\\\t");s=this.blueConicClient.json.parse(o)}catch(t){s=null}this.blueConicClient.event.publish("bcComplexObject",{plugin:r,config:s,node:n,interactionId:this.context.getInteractionId()}),this.blueConicClient.isInEditMode()||(n.removeAttribute("data-bc-pluginid"),n.removeAttribute("data-bc-config"))}},_handleStyling:function(){var t="bcIS"+this.context.getInteractionId(),e=this.parameters.styling_css_inline&&this.parameters.styling_css_inline[0]?this.parameters.styling_css_inline[0]:"";e&&(this.inlineCss=document.getElementById(t),this.inlineCss||(this.inlineCss=document.createElement("style"),this.inlineCss.id=t,this.inlineCss.innerHTML=e.replace(/&#xd;/gi,""),document.head.appendChild(this.inlineCss)))}};try{var InteractionTypeImpl=InteractionType.extend(contentSpecial)}catch(t){try{module.exports=contentSpecial}catch(t){}};var a = [];var i='contentinteractiontypespecial';a.push({url: blueConic.fn.getBCHostnameAwarePluginsRepositoryUrl(ps, pf) + i + '/4.2.0/frontend/src/node_modules/@blueconic/jquery-x-jquerymigrate/load_jQuery3_7_X_jQueryMigrate.min.js', sharing: 'local'});blueConic.fn.registerInteractionType(i, InteractionTypeImpl, a, [{ id : i, baseUrl : blueConic.fn.getBCHostnameAwarePluginsRepositoryUrl(ps, pf) + i + '/4.2.0/'},{ id : 'boolean', baseUrl : blueConic.fn.getBCHostnameAwarePluginsRepositoryUrl(ps, pf) + 'boolean/1.0.1/'},{ id : 'html', baseUrl : blueConic.fn.getBCHostnameAwarePluginsRepositoryUrl(ps, pf) + 'html/1.0.10/'},{ id : 'string', baseUrl : blueConic.fn.getBCHostnameAwarePluginsRepositoryUrl(ps, pf) + 'string/1.0.1/'}]);})();(function(){ var InteractionTypeImpl=InteractionType.extend({init:function(e,t){this.blueConicClient=e,this.context=t},onLoad:function(){var e=this.blueConicClient,t=this.context.getParameters(),n=this.jQuery;if(t){var r=(t.clickcandidates||[]).map(JSON.parse).map(_updateSelectorCandidate),a=(t.contentcandidates||[]).map(JSON.parse).map(_updateSelectorCandidate),i={},o={},c={};r.forEach((function(e){candidateChecker(e,registerClickHandlers)})),a.forEach((function(e){candidateChecker(e,checkContentHandler)}))}function candidateChecker(t,n){var handler=function(){n(t);var r=o[t.interactionId],a=c[t.selecterarea];r||a||e.position.subscribe(t.selecterarea,null,handler)};e.position.subscribe(t.selecterarea,null,handler),n(t)}function registerClickHandlers(e){for(var t=getHandler(e),r=n(e.selecterarea),a=0,i=r.length;a<i;a++)r[a].addEventListener("click",t,{once:!0})}function checkContentHandler(e){isContentConversionMomentMet(e)&&getHandler(e)()}function isContentConversionMomentMet(e){if(o[e.interactionId])return!1;for(var t=n(e.selecterarea),r=0,a=t.length;r<a;r++)if(_textContains(t[r].textContent,e.words))return!0;return!1}function getHandler(t){return i[t.interactionId]||(i[t.interactionId]=function(i,l){var s=o[i],u=c[t.selecterarea];if(!s&&!u){var d=[];d=(d=l instanceof MouseEvent?r.filter((function(e){var t=!o[e.interactionId],r=n(e.selecterarea).is(event.target),a=n(e.selecterarea).find(event.target).length>0;return t&&(r||a)})):a.filter((function(e){return isContentConversionMomentMet(e)}))).filter((function(e){return e.interactionId!==t.interactionId})),c[t.selecterarea]=!0,c[t.interactionId]=!0,d.forEach((function(e){c[e.selecterarea]=!0,o[e.interactionId]=!0}));var f=d.map((function(e){return e.interactionId}));e.createEvent("CONVERSION",i,null,(function(){e.util.log("CONVERSION event registered. Interaction: ["+i+"]")}),{losingInteractions:f})}}.bind(null,t.interactionId)),i[t.interactionId]}function _textContains(e,t){if(!e||!Array.isArray(t))return!1;var n=t.filter((function(e){return Boolean(e)&&"pre_any"!==e})).map((function(e){return e.trim().toLowerCase()}));if(0===n.length)return!0;for(var r=e.toLowerCase(),a=0,i=n.length;a<i;a++)if(r.indexOf(n[a])>=0)return!0;return!1}function _updateSelectorCandidate(e){var t=e.selecterarea;return/^pre_any/.test(t)?t="html":/^pre_header/.test(t)?t="h1, h2, h3, h4, h5, h6":/^pre_/.test(t)&&(t=t.replace(/^pre_/,"")),e.selecterarea=t,e}}});var a = [];var i='conversionlistenerinteractiontype';a.push({url: blueConic.fn.getBCHostnameAwarePluginsRepositoryUrl(ps, pf) + i + '/1.1.11/frontend/src/node_modules/@blueconic/jquery-x-jquerymigrate/load_jQuery3_7_X_jQueryMigrate.min.js', sharing: 'local'});blueConic.fn.registerInteractionType(i, InteractionTypeImpl, a, [{ id : i, baseUrl : blueConic.fn.getBCHostnameAwarePluginsRepositoryUrl(ps, pf) + i + '/1.1.11/'}]);})();(function(){ var InteractionTypeImpl=InteractionType.extend({init:function(e,t){this.blueConicClient=e,this.context=t,this.interactionId=this.context.getInteractionId(),this.parameters=this.context.getParameters()},onLoad:function(){let e="_bcDataLayerEventTriggerListenerLoaded_"+this.interactionId;if(!window[e]){window[e]=!0,this.amountProcssedDataLayerEntry=0,this.eventsToPublish=[],this.eventsThatTriggerPageview=[];try{this.dataLayer=window[this.parameters.dataLayer[0]]?window[this.parameters.dataLayer[0]]:window.dataLayer||[]}catch(e){this.dataLayer=window.dataLayer||[]}this.eventsToPublish=this.parameters.eventNames?this.parameters.eventNames:[],this.eventsThatTriggerPageview=this.parameters.eventNamesTriggerPageview?this.parameters.eventNamesTriggerPageview:[],this._checkForOldVersion(),0===this.eventsToPublish.length&&0===this.eventsThatTriggerPageview.length||setInterval((()=>{try{this._processDataLayer()}catch(e){}}),200)}},_checkForOldVersion:function(){this.eventsToPublish.length>0&&this.eventsToPublish[0].includes(",")&&(this.eventsToPublish=this.eventsToPublish[0].split(",")),this.eventsThatTriggerPageview.length>0&&this.eventsThatTriggerPageview[0].includes(",")&&(this.eventsThatTriggerPageview=this.eventsThatTriggerPageview[0].split(","))},_publishEvent:function(e,t){e&&t&&this.blueConicClient.event.publish(e,[t])},_processDataLayer:function(){let e=this.dataLayer.slice(this.amountProcssedDataLayerEntry);this.amountProcssedDataLayerEntry=this.amountProcssedDataLayerEntry+e.length;for(let t of e)if(t&&t.event&&this.eventsToPublish.includes(t.event)&&this._publishEvent(t.event,t),t&&t.event&&this.eventsThatTriggerPageview.includes(t.event)){let e=this;setTimeout((()=>{e.blueConicClient.handlePageView()}),100)}}});var a = [];var i='datalayer_event_trigger_listener';blueConic.fn.registerInteractionType(i, InteractionTypeImpl, a, [{ id : i, baseUrl : blueConic.fn.getBCHostnameAwareLocalPluginsUrl() + '/plugins/datalayer_event_trigger_listener/ts_5e3dda806e0b0ac685f575cfcdd29597/'}]);})();(function(){ !function(){var t=null,e=null,i=null,n=null,o=null;window.InteractionTypeImpl=InteractionType.extend({init:function(t,e){this.blueConicClient=t,this.context=e,this.parameters=this.context.getParameters(),this.customCssElements=[],this.customJsElements=[],this.isInEditMode=this.blueConicClient.isInEditMode(),this._temporyLocation=null,this._contentElement=null,this._openedOnce=!1,this._resetTimeoutId=0,this.baseURL=this.blueConicClient.getBaseURL(this.context.getInteractionTypeId())},onLoad:function(){t=window._bcp.notificationBar.Enums.FLOW_TYPE,e=window._bcp.notificationBar.Enums.POSITION,i=window._bcp.notificationBar.Enums.ENTER_ANIMATION,n=window._bcp.notificationBar.Enums.APPEAR_ON,o=window._bcp.notificationBar.Enums.CLOSE_POSITION,this.parseParameters(),this.isInEditMode&&(window._bcp.notificationBar.NotificationBarModern.prototype.close=function(){},window._bcp.notificationBar.NotificationBar.prototype.close=function(){});var r=this;this.loadCustomContent((function(t){if(t)return r.blueConicClient.util.log(t.message);r.addBlueConicEventHandlers()}))},parseParameters:function(){this.notificationBarHeight=parseInt(this.getParameter("height")),this.notificationBarHeight=isNaN(this.notificationBarHeight)?window._bcp.notificationBar.Constants.DEFAULT_HEIGHT:this.notificationBarHeight;var r=this.getParameter("location")||"top";this._position="top"===r?e.TOP:e.BOTTOM;var s=this.getParameter("close_position");if(this._closePosition="TOP_LEFT"===s?o.TOP_LEFT:"BOTTOM_RIGHT"===s?o.BOTTOM_RIGHT:o.TOP_RIGHT,this._closePadding=parseInt(this.getParameter("close_padding")),this._closePadding=isNaN(this._closePadding)?10:this._closePadding,document.body.style.animationName===undefined||!0===this.isInEditMode)this._enterAnimation=i.NONE;else switch(this.getParameter("effect")){case"slideIn":this._enterAnimation=i.SLIDE_IN;break;case"fadeIn":this._enterAnimation=i.FADE_IN;break;default:this._enterAnimation=i.NONE}var a=this.getParameters("selected_when");this._appearOnTriggers=[];for(var c=0;c<a.length;c++)switch(a[c]){case"triggerOn":this._appearOnTriggers.push(n.SCROLL_EVENT);break;case"scroll_depth":this._appearOnTriggers.push(n.SCROLL_DEPTH);break;case"click_selector":this._appearOnTriggers.push(n.ELEMENT_CLICKED);break;case"content_condition":this._appearOnTriggers.push(n.CONTENT_VISIBLE)}0===this._appearOnTriggers.length&&this._appearOnTriggers.push(n.PAGE_LOAD);var l=this.getParameter("location_type");this._type="scroll"===l?t.NON_STICKY:t.STICKY,this._useModernPosition=this.getParameter("use_modern_position")},addBlueConicEventHandlers:function(){this.blueConicClient.event.subscribe("closeoverlay",this,(function(t,e){e instanceof Array&&e[0]===this.context.getInteractionId()&&this.notificationBar.close()})),this.blueConicClient.event.subscribe(this.blueConicClient.event.onUrlChange,this,(function(){this.notificationBar&&this.notificationBar.isVisible&&this.notificationBar.close()}))},loadCustomContent:function(t){t||(t=function(){});var e=this;this.callbackChain([this.createContentElement.bind(this),this.loadComplexObjects.bind(this),this.removeTempLocation.bind(this),this.loadCss.bind(this),this.loadCustomCss.bind(this)],(function(i){return i?t(i):(e.createNotificationBar(),e.setShowEventTrigger(),e.isInEditMode&&e.blueConicClient.event.publish("notificationBar.interactionLoaded",{interaction:e}),t())}))},callbackChain:function(t,e,i){var n=this;i||(i=0);try{t[i]((function(o){return o?e(o):i+1>=t.length?e(null):n.callbackChain(t,e,i+1)}))}catch(o){return e(o)}},createContentElement:function(t){return this._temporyLocation=document.createElement("div"),this._temporyLocation.style.display="none",document.body.appendChild(this._temporyLocation),this._contentElement=document.createElement("div"),this._contentElement=this.jQuery("<div></div>").html(this.getContent())[0],this._temporyLocation.appendChild(this._contentElement),t()},removeTempLocation:function(t){return document.body.removeChild(this._temporyLocation),t()},loadComplexObjects:function(t){this.jQuery(this._contentElement).find("div[data-bc-external]").html("");for(var e=this.jQuery(this._contentElement).find("div[data-bc-pluginid]"),i=0;i<e.length;i++){var n=e.eq(i),o=n.attr("data-bc-pluginid"),r=n.attr("data-bc-config");if(r)try{for(var s=r.match(/: *"(\\"|[^"])*\n(\\"|[^"])*"/g)||[],a=r,c=0;c<s.length;c++)a=a.replace(s[c],s[c].replace(/\n/g,"\\n"));r=this.blueConicClient.json.parse(a)}catch(d){console.error("Error parsing the config of the complex object:",d),r=null}this.blueConicClient.event.publish("bcComplexObject",{plugin:o,config:r,node:n[0],interactionId:this.context.getInteractionId()}),this.isInEditMode||(n.removeAttr("data-bc-pluginid"),n.removeAttr("data-bc-config"))}if(0===e.length)return t();var l=0,h=setInterval((function(){if(0===e.length)return clearInterval(h),clearTimeout(l),t();for(var i=e.length-1;i>=0;i--)e.eq(i).html()&&e.splice(i,1)}),10);l=setTimeout((function(){return clearInterval(h),t({message:"Couldn't load the complex objects (timeout of 5000ms passed)."})}),5e3)},loadCss:function(t){var e=document.createElement("link");e.setAttribute("type","text/css"),e.setAttribute("rel","stylesheet"),e.onload=function(){t()};var i=this.baseURL;e.onerror=function(e){return t({message:"Error occurred loading the main css file ("+i+"frontend/src/css/notificationBar.css)",eventData:e})},this.jQuery("head").append(e),e.setAttribute("href",this.baseURL+"frontend/src/css/notificationBar.css")},loadCustomCss:function(t){var e=this,i=this.getParameter("styling_css"),n=this.getParameter("styling_css_inline");if(i){var o=document.createElement("link");o.setAttribute("type","text/css"),o.setAttribute("rel","stylesheet"),o.onload=function(){t()},o.onerror=function(n){return e.isInEditMode?(console.error("[BC] Loading the custom css failed for the following url: "+i),t()):t({message:"Loading the custom css failed for the following url: "+i,eventData:n})},this.customCssElements.push(this.jQuery(o)),this.jQuery("head").append(this.jQuery(o)),o.setAttribute("href",i)}if(n){n=n.replace(/&#xd;/gi,"");var r=this.jQuery("<style>"+n+"</style>");this.customCssElements.push(r),this.jQuery("head").append(r)}if("false"===this.getParameter("show_close")){var s=this.jQuery("<style>.bcpNotificationBarClose { display: none; }</style>");this.customCssElements.push(s),this.jQuery("head").append(s)}else if("true"===this.getParameter("custom_close")){var a=this.getParameter("close_icon"),c=this.getParameter("close_icon_hover"),l="";a&&(l+=".bcpNotificationBarCloseIcon {border-radius: 0;background-image: url("+a+");background-position: 0;background-size: contain;}.bcpNotificationBarCloseIcon:hover {background-position: 0;}"),c&&(l+=".bcpNotificationBarCloseIcon:hover {background-image: url("+c+");}");var h=this.jQuery("<style>"+l+"</style>");this.customCssElements.push(h),this.jQuery("head").append(h)}if(!i)return t()},resetCustomCss:function(){for(var t=0;t<this.customCssElements.length;t++){this.customCssElements[t].remove()}this.customCssElements=[]},triggerOnScrollDepth:function(){this.getTargetElement().scrollTop()/(this.jQuery(document).height()-this.getTargetElement().height())*100>=parseInt(this.getParameter("scroll_depth"))&&(this.getTargetElement().off("scroll.bcpNotificationBarTrigger"),this.triggerNotificationBar())},setShowEventTrigger:function(){for(var t=this,e=0;e<this._appearOnTriggers.length;e++)switch(this._appearOnTriggers[e]){case n.PAGE_LOAD:this.triggerNotificationBar();break;case n.SCROLL_EVENT:this.getTargetElement().off("scroll.bcpNotificationBarTriggerEvent").one("scroll.bcpNotificationBarTriggerEvent",(function(){t.triggerNotificationBar()}));break;case n.SCROLL_DEPTH:t.triggerOnScrollDepth(),this.getTargetElement().off("scroll.bcpNotificationBarTriggerDepth").on("scroll.bcpNotificationBarTriggerDepth",(function(){t.triggerOnScrollDepth()}));break;case n.ELEMENT_CLICKED:this.jQuery(this.getParameter("click_selector")).off("click.bcpNotificationBarTrigger").on("click.bcpNotificationBarTrigger",(function(){!1===t.notificationBar.isVisible&&t.triggerNotificationBar()}));break;case n.CONTENT_VISIBLE:this._addTriggerOnContentHandler(t.getParameter("content_condition"))}},_addTriggerOnContentHandler:function(t){var e=this,i=null,n=null,checkAndTriggerFunction=function(){e.jQuery(t).length>0&&e.jQuery(t).html().length>0&&(e.triggerNotificationBar(),i&&i.disconnect(),n&&clearInterval(n))};window.MutationObserver?(i=new MutationObserver(checkAndTriggerFunction)).observe(document.body,{childList:!0,subtree:!0}):n=setInterval(checkAndTriggerFunction,1e3),checkAndTriggerFunction()},triggerNotificationBar:function(){var t=parseInt(this.getParameter("delay")),e=this;function _trigger(){e.callbackChain([function(t){e._handleJavascript((function(i){return i&&!e.isInEditMode?t(i):(e._addInlineJavascript(),t())}))},e.notificationBar.show.bind(e.notificationBar),function(t){return!1===e._openedOnce&&(e._addFrontEndBindings(),e._addClickEventLogger(),e.blueConicClient.createEvent("VIEW",e.context.getInteractionId()),e._openedOnce=!0),!0===e.isInEditMode&&setTimeout((function(){e.notificationBar.scrollIntoView()}),1e3),t()}],(function(t){t&&console.error(t)}))}t&&!isNaN(t)&&!0!==this.isInEditMode||(t=0),0===t?_trigger():setTimeout(_trigger,1e3*t)},_addFrontEndBindings:function(){var t=this.jQuery(".bcpNotificationBarDontShowAgainLink"),e=this.jQuery(".bcpNotificationBarCloseButton"),i=this.jQuery(".bcpNotificationBarCloseIcon"),n=this;i.on("click",(function(){"true"===n.getParameter("hide_after_close")&&n.blueConicClient.doNotShowAgain(n.context.getInteractionId()),n.notificationBar.close()})),t.on("click",(function(t){t.preventDefault(),n.blueConicClient.doNotShowAgain(n.context.getInteractionId()),n.notificationBar.close()})),e.on("click",(function(){n.notificationBar.close()}))},_addClickEventLogger:function(){var t=this.getParameter("click_event_selector");if(t){var e=this;this.jQuery(t).off("click.bcpNotificationBar").one("click.bcpNotificationBar",(function(t){t&&t.target&&t.target.pathname&&t.target.hostname&&0===t.target.pathname.indexOf("/s/")&&-1!==t.target.hostname.indexOf("blueconic")||e.blueConicClient.createEvent("CLICK",e.context.getInteractionId())}))}},_addInlineJavascript:function(){var t=this.getParameter("javascript");if(t&&!this.isInEditMode){t=t.replace(/(^|\W)blueConicVariantId(\W|$)/g,'$1"'+this.context.getInteractionId()+'"$2');var e=this.jQuery("<script>"+t+"<\/script>");try{e.appendTo(this.jQuery("body"))}catch(i){console.error(i)}}},_handleJavascript:function(t){var e=this.getParameters("javascript_urls")||[],i=this;if(0===e.length)return t();{var n=null,o=0;function scriptLoaded(){if(++o===e.length)return i.isInEditMode?t():t(n)}function scriptError(t){(n=n||{message:"[BC] Loading for the following javascript urls failed, notificationBar will not be shown.",urls:[]}).urls.push(t),scriptLoaded()}for(var r=0;r<e.length;r++){var s=e[r],a=document.createElement("script");a.setAttribute("src",s),a.onload=scriptLoaded,a.onerror=scriptError.bind(null,s),document.head.appendChild(a)}}},onSave:function(){return this.notificationBar.getContentHTML()},onMessageReceived:function(t){this.blueConicClient.event.publish("notificationBar.messageReceived",t)},getContent:function(){var t=this.getParameter("content");if(!t){var e="nl"===this.context.getLocale()?"nl":"default";t=window._bcp.notificationBar.Constants.HTML[e].content}return t},createNotificationBar:function(){"true"===this._useModernPosition?this.notificationBar=new window._bcp.notificationBar.NotificationBarModern(this.blueConicClient,this.context,this.jQuery,this._contentElement,{closePosition:this._closePosition,closePadding:this._closePadding,flowType:this._type,position:this._position,animationType:this._enterAnimation,height:this.notificationBarHeight,isInEditMode:this.isInEditMode}):this.notificationBar=new window._bcp.notificationBar.NotificationBar(this.blueConicClient,this.context,this.jQuery,this._contentElement,{closePosition:this._closePosition,closePadding:this._closePadding,flowType:this._type,position:this._position,animationType:this._enterAnimation,height:this.notificationBarHeight})},resetNotificationBar:function(){this.notificationBar.domModifier&&this.notificationBar.domModifier.reset(!1),this.jQuery(this.notificationBar._containerElement).remove(),this.resetCustomCss();var t=this;this.loadCustomCss((function(){t.createNotificationBar(),t.notificationBar.show(),!0===t.isInEditMode&&t.notificationBar.scrollIntoView()}))},getParameter:function(t){return this.parameters[t]&&this.parameters[t][0]?this.parameters[t][0]:null},getParameters:function(t){return this.parameters[t]?this.parameters[t]:[]},getTargetElement:function(){return document.documentElement.scrollHeight>jQuery(window).height()?this.jQuery(window):this.jQuery("body")}})}();var a = [];var i='dialogue_notification_bar';a.push({url: blueConic.fn.getBCHostnameAwarePluginsRepositoryUrl(ps, pf) + i + '/1.4.2/frontend/src/node_modules/@blueconic/jquery-x-jquerymigrate/load_jQuery3_7_X_jQueryMigrate.min.js', sharing: 'local'});a.push({url: blueConic.fn.getBCHostnameAwarePluginsRepositoryUrl(ps, pf) + i + '/1.4.2/frontend/src/scripts/enumsAndConstants.js', sharing: 'none'});a.push({url: blueConic.fn.getBCHostnameAwarePluginsRepositoryUrl(ps, pf) + i + '/1.4.2/frontend/src/scripts/elementModifier.js', sharing: 'none'});a.push({url: blueConic.fn.getBCHostnameAwarePluginsRepositoryUrl(ps, pf) + i + '/1.4.2/frontend/src/scripts/domModifier.js', sharing: 'none'});a.push({url: blueConic.fn.getBCHostnameAwarePluginsRepositoryUrl(ps, pf) + i + '/1.4.2/frontend/src/scripts/notificationBar.js', sharing: 'none'});a.push({url: blueConic.fn.getBCHostnameAwarePluginsRepositoryUrl(ps, pf) + i + '/1.4.2/frontend/src/scripts/notificationBarModern.js', sharing: 'none'});blueConic.fn.registerInteractionType(i, InteractionTypeImpl, a, [{ id : i, baseUrl : blueConic.fn.getBCHostnameAwarePluginsRepositoryUrl(ps, pf) + i + '/1.4.2/'},{ id : 'boolean', baseUrl : blueConic.fn.getBCHostnameAwarePluginsRepositoryUrl(ps, pf) + 'boolean/1.0.1/'},{ id : 'html', baseUrl : blueConic.fn.getBCHostnameAwarePluginsRepositoryUrl(ps, pf) + 'html/1.0.10/'},{ id : 'image', baseUrl : blueConic.fn.getBCHostnameAwarePluginsRepositoryUrl(ps, pf) + 'image/1.0.3/'},{ id : 'number', baseUrl : blueConic.fn.getBCHostnameAwarePluginsRepositoryUrl(ps, pf) + 'number/1.0.2/'},{ id : 'string', baseUrl : blueConic.fn.getBCHostnameAwarePluginsRepositoryUrl(ps, pf) + 'string/1.0.1/'}]);})();(function(){ var InteractionTypeImpl=InteractionType.extend({init:function(e,t){this.blueConicClient=e,this.context=t,this.parameters=this.context.getParameters();var r=new Date(2017,8,1,0,0,0,0),s=this.blueConicClient.getCurrentDate().getTime()-r.getTime();this.days=Math.floor(s/864e5);var i=this.parameters.propertyRules&&this.parameters.propertyRules[0]?this.parameters.propertyRules[0]:null;if(i){i=e.json.parse(i),this.preLoadProperties=[];for(var a=0,p=0;p<i.length;p++){var n=i[p];n.profileproperty&&n.decay&&n.nr&&(this.preLoadProperties.push(n.profileproperty+"_index"),n.decay>a&&(a=n.decay,this.property=n.profileproperty))}}else{var o=this.parameters.property?this.parameters.property[0]:this.parameters.property;o&&(this.property=this.blueConicClient.json.parse(o)[0].profileproperty,this.preLoadProperties=[this.property+"_index"])}},getPreloadProperties:function(){return this.preLoadProperties},onLoad:function(){if(this.preLoadProperties.length>0){var e=this.context.getProfile(),t=this.parameters.engagement_rules?this.parameters.engagement_rules[0]:this.parameters.engagement_rules;if(!t)return;if(0===(t=this.blueConicClient.json.parse(t)).length)return;var r=this.parameters.interests?this.parameters.interests[0]:this.parameters.interests;r=r?this.blueConicClient.json.parse(r).values:[];var s=new this.BlueConicEngagement(this.blueConicClient,e,this.context.getInteractionId(),!0,r,this.jQuery,this.days,!0);if(s.applyEngagementRules(t),s.isChanged())s.save();else{for(var i=!1,a=0;a<this.preLoadProperties.length;a++){var p=this.preLoadProperties[a];e.getValue(p)||(e.setValue(p,"0"),i=!0)}i&&this.blueConicClient.profile.updateProfile()}}}});var a = [];var i='engagement_interest_ranking';a.push({url: blueConic.fn.getBCHostnameAwarePluginsRepositoryUrl(ps, pf) + i + '/6.4.5/frontend/src/node_modules/@blueconic/jquery-x-jquerymigrate/load_jQuery3_7_X_jQueryMigrate.min.js', sharing: 'local'});a.push({url: blueConic.fn.getBCHostnameAwarePluginsRepositoryUrl(ps, pf) + i + '/6.4.5/frontend/src/node_modules/@blueconic/engagement-service/engagementService.js', sharing: 'local'});blueConic.fn.registerInteractionType(i, InteractionTypeImpl, a, [{ id : i, baseUrl : blueConic.fn.getBCHostnameAwarePluginsRepositoryUrl(ps, pf) + i + '/6.4.5/'}]);})();(function(){ var InteractionTypeImpl=InteractionType.extend({init:function(e,r){this.blueConicClient=e,this.interaction=r,this.parameters=this.interaction.getParameters();var t=this.parameters.propertyRules&&this.parameters.propertyRules[0]?this.parameters.propertyRules[0]:null;if(t){t=e.json.parse(t),this.preLoadProperties=[];for(var i=0,s=0;s<t.length;s++){var p=t[s];p.profileproperty&&p.decay&&(this.preLoadProperties.push(p.profileproperty),p.decay>i&&(i=p.decay,this.property=p.profileproperty))}}else{var a=this.parameters.property?this.parameters.property[0]:this.parameters.property;a&&(this.property=this.blueConicClient.json.parse(a)[0].profileproperty,this.preLoadProperties=[this.property])}},getPreloadProperties:function(){return this.preLoadProperties},onLoad:function(){if(this.preLoadProperties.length>0){var e=this.interaction.getProfile(),r=this.parameters.engagement_rules?this.parameters.engagement_rules[0]:this.parameters.engagement_rules;if(!r)return;if(0===(r=this.blueConicClient.json.parse(r)).length)return;var t=new this.BlueConicEngagement(this.blueConicClient,e,this.property,!1,"",this.jQuery);if(t.applyEngagementRules(r),t.isChanged())t.save();else{for(var i=!1,s=0;s<this.preLoadProperties.length;s++){var p=this.preLoadProperties[s];e.getValue(p)||(e.setValue(p,"0"),i=!0)}i&&this.blueConicClient.profile.updateProfile()}}}});var a = [];var i='engagement_score';a.push({url: blueConic.fn.getBCHostnameAwarePluginsRepositoryUrl(ps, pf) + i + '/6.5.5/frontend/src/node_modules/@blueconic/jquery-x-jquerymigrate/load_jQuery3_7_X_jQueryMigrate.min.js', sharing: 'local'});a.push({url: blueConic.fn.getBCHostnameAwarePluginsRepositoryUrl(ps, pf) + i + '/6.5.5/frontend/src/node_modules/@blueconic/engagement-service/engagementService.js', sharing: 'local'});blueConic.fn.registerInteractionType(i, InteractionTypeImpl, a, [{ id : i, baseUrl : blueConic.fn.getBCHostnameAwarePluginsRepositoryUrl(ps, pf) + i + '/6.5.5/'}]);})();(function(){ var InteractionTypeImpl=InteractionType.extend({init:function(e,r){this.blueConicClient=e,this.context=r},getPreloadProperties:function(){return this.preloadProperties=[],this.context&&(this.preloadProperties=this.getProfilePropertiesFromParameters(this.context.getParameters())),this.preloadProperties},onLoad:function(){var e=this.context.getProfile(),r=this.context.getParameters(),t=this.jQuery,i=r.listener_rules?r.listener_rules[0]:r.listener_rules;if(i){i=this.blueConicClient.json.parse(i);var s=new this.RuleService(this.blueConicClient,e,t);s.applyRules(i),s.save()}},getProfilePropertiesFromParameters:function(e){var r=[],t=e.listener_rules?e.listener_rules[0]:e.listener_rules;if(!t)return r;t=this.blueConicClient.json.parse(t);for(var i=0;i<t.rules.length;i++){var s=t.rules[i];!s.profileproperty||"set_if_empty"!==s.addset&&"merge"!==s.addset||r.push(s.profileproperty[0].profileproperty)}return r}});var a = [];var i='enrichprofilebyvisitorbehavior';a.push({url: blueConic.fn.getBCHostnameAwarePluginsRepositoryUrl(ps, pf) + i + '/5.4.9/frontend/src/node_modules/@blueconic/jquery-x-jquerymigrate/load_jQuery3_7_X_jQueryMigrate.min.js', sharing: 'local'});a.push({url: blueConic.fn.getBCHostnameAwarePluginsRepositoryUrl(ps, pf) + i + '/5.4.9/frontend/src/js/ruleService.js', sharing: 'local'});blueConic.fn.registerInteractionType(i, InteractionTypeImpl, a, [{ id : i, baseUrl : blueConic.fn.getBCHostnameAwarePluginsRepositoryUrl(ps, pf) + i + '/5.4.9/'}]);})();(function(){ var InteractionTypeImpl=InteractionType.extend({init:function(e,r){this.blueConicClient=e,this.context=r,this.parameters=this.context.getParameters(),this.rules=this._migrate(this.parameters.version||1)},getPreloadProperties:function(){return this.preloadProperties=[],this.context&&(this.preloadProperties=this.getProfilePropertiesFromParameters()),this.preloadProperties},onLoad:function(){if(this.rules){var e=this.context.getProfile();new window.FormRuleService(this.blueConicClient,e,this.jQuery).applyRules(this.rules)}},getProfilePropertiesFromParameters:function(){if(this.rules){for(var e=[],r=0;r<this.rules.length;r++){var t=this.rules[r];t.profileProperty&&"set_if_empty"===t.addset&&e.push(t.profileProperty)}return e}},_migrate:function(e){var r=this.parameters.form_listener_rules?this.parameters.form_listener_rules[0]:this.parameters.form_listener_rules;return r=this.blueConicClient.json.parse(r),1===e&&(e=2,r=this._migrateToVersion2(r)),r},_migrateToVersion2:function(e){if(!e)return e;e=e.rules||e;for(var r=0;r<e.length;r++){e[r].id=e[r].id||e[r].identifier,delete e[r].identifier,e[r].profileproperty&&!e[r].profileProperty&&(e[r].profileProperty=e[r].profileproperty[0]&&e[r].profileproperty[0].profileproperty||"",delete e[r].profileproperty);var t=this._migrateConverterMappingsToVersion2(e[r]);t&&(e[r].converter.mappings=t)}return e},_migrateConverterMappingsToVersion2:function(e){if(e&&e.converter&&e.converter.mappings){for(var r=[],t=0;t<e.converter.mappings.length;t++){var i=e.converter.mappings[t];i&&i.original&&i.converted?r.push(i):r.push({id:i.identifier||i.id,original:i.o,converted:i.c})}return r}}});var a = [];var i='enrichprofilewithvisitorinput';a.push({url: blueConic.fn.getBCHostnameAwarePluginsRepositoryUrl(ps, pf) + i + '/4.4.6/frontend/src/node_modules/@blueconic/jquery-x-jquerymigrate/load_jQuery3_7_X_jQueryMigrate.min.js', sharing: 'local'});a.push({url: blueConic.fn.getBCHostnameAwarePluginsRepositoryUrl(ps, pf) + i + '/4.4.6/frontend/src/node_modules/@blueconic/frontend-form-rule-service/formRuleService.js', sharing: 'local'});blueConic.fn.registerInteractionType(i, InteractionTypeImpl, a, [{ id : i, baseUrl : blueConic.fn.getBCHostnameAwarePluginsRepositoryUrl(ps, pf) + i + '/4.4.6/'}]);})();(function(){ var InteractionTypeImpl=InteractionType.extend({init:function(a,b){this.blueConicClient=a,this.context=b,this.parameters=this.context.getParameters()},_ouibounce:function(){var a=this,b="sensitivity",c="delay";this.ouibounce({aggressive:!0,timer:0,sensitivity:this.parameters[b]?parseInt(this.parameters[b][0]):20,delay:this.parameters[c]?parseInt(this.parameters[c][0]):0,callback:function(){window.blueConicClient&&window.blueConicClient.exitIntentThrown||a.blueConicClient.createEvent("exitintent"),window.blueConicClient&&(window.blueConicClient.exitIntentThrown=!0)}})},onLoad:function(){this.blueConicClient.event.subscribe(this.blueConicClient.event.onUrlChange,this,function(){window.blueConicClient&&window.blueConicClient.exitIntentThrown&&(window.blueConicClient.exitIntentThrown=!1,this._ouibounce())}),this._ouibounce()}});var a = [];var i='exitintent';a.push({url: blueConic.fn.getBCHostnameAwarePluginsRepositoryUrl(ps, pf) + i + '/2.0.5/js/ouibounce.js', sharing: 'none'});blueConic.fn.registerInteractionType(i, InteractionTypeImpl, a, [{ id : i, baseUrl : blueConic.fn.getBCHostnameAwarePluginsRepositoryUrl(ps, pf) + i + '/2.0.5/'}]);})();(function(){ var InteractionTypeImpl=InteractionType.extend({init:function(e,i){if(this.blueConicClient=e,this.context=i||null,this.parameters=this.context.getParameters(),this._initPublishedEvents(),this.parameters){this.blueConicClient.event.subscribe("PAGEVIEW",this,(function(){window._bcp=window._bcp||{},window._bcp.publishedEvents=window._bcp.publishedEvents||{},window._bcp.publishedEvents.viewEvent={}})),"true"!==this.parameters.hasOverlay[0]||this._isViewEventPublished()||this._handleView();var t=this.parameters.positions;if(t)for(var n=0;n<t.length;n++){var s=t[n];this.blueConicClient.position.subscribe(s,this,this._handlePosition)}}},_initPublishedEvents:function(){window._bcp=window._bcp||{},window._bcp.publishedEvents=window._bcp.publishedEvents||{},window._bcp.publishedEvents.viewEvent=window._bcp.publishedEvents.viewEvent||{},window._bcp.publishedEvents.clickEvent=window._bcp.publishedEvents.clickEvent||{}},_handleClick:function(){this._isClickEventPublished()||(this._setClickEventPublished(!0),this.blueConicClient.createEvent("CLICK",this.context.getInteractionId()))},_handleView:function(){this._setViewEventPublished(!0),this.blueConicClient.createEvent("VIEW",this.context.getInteractionId())},_handlePosition:function(e){this._isViewEventPublished()||this.blueConicClient.isInEditMode()||this._handleView();var i=this;try{var t="bcCtrl"+this.context.getInteractionId();if(this.jQuery(e+" a").off("click."+t).on("click."+t,(function(){i._handleClick()})),this.jQuery(document).off("click."+t).on("click."+t,e+" a",(function(){i._handleClick()})),this.jQuery(document).off("submit."+t).on("submit."+t,e+" form",(function(){i._handleClick()})),this.jQuery(e).find("iframe").length>0){window.focus();var n=!1,s=this.jQuery(this.jQuery(e).find("iframe"));s.off("mouseenter."+t).on("mouseenter."+t,(function(){n=!0})),s.off("mouseleave."+t).on("mouseleave."+t,(function(){n=!1})),document.querySelectorAll(window).removeEventListener("blur."+t).addEventListener("blur."+t,function(){n&&this._handleClick()}.bind(this))}}catch(o){}},onLoad:function(){if(this.parameters){var e=this.parameters.positions;if(e)for(var i=0;i<e.length;i++){var t=e[i];this.jQuery(t).length>0&&this._handlePosition(t)}}},_isViewEventPublished:function(){return Boolean(window._bcp.publishedEvents.viewEvent[this.context.getInteractionId()])},_setViewEventPublished:function(e){window._bcp.publishedEvents.viewEvent[this.context.getInteractionId()]=e},_isClickEventPublished:function(){return Boolean(window._bcp.publishedEvents.clickEvent[this.context.getInteractionId()])},_setClickEventPublished:function(e){window._bcp.publishedEvents.clickEvent[this.context.getInteractionId()]=e}});var a = [];var i='globallistener_controlgroup';a.push({url: blueConic.fn.getBCHostnameAwarePluginsRepositoryUrl(ps, pf) + i + '/1.1.3/frontend/src/node_modules/@blueconic/jquery-x-jquerymigrate/load_jQuery3_7_X_jQueryMigrate.min.js', sharing: 'local'});blueConic.fn.registerInteractionType(i, InteractionTypeImpl, a, [{ id : i, baseUrl : blueConic.fn.getBCHostnameAwarePluginsRepositoryUrl(ps, pf) + i + '/1.1.3/'}]);})();(function(){ var InteractionTypeImpl=InteractionType.extend({init:function(a,b){this.blueConicClient=a,this.context=b,this.parameters=this.context.getParameters(),this.profile=this.blueConicClient.profile.getProfile(),this.amountProcessedDataLayerEntry=0},_getConsentEvent:function(){try{let a=window.dataLayer||[],b=a.slice(this.amountProcessedDataLayerEntry);this.amountProcessedDataLayerEntry+=b.length;let c,d=b.filter((a)=>"consent"===a[0]);if(0===d.length)throw new Error("No consent events found");return c=1<d.length?d[d.length-1]:d[0],c}catch(a){throw new Error(`Something happened while getting the consent event: ${a.message}`)}},_processConsent:function(a){let b={ad_storage:this.parameters.adStorage?this.parameters.adStorage:null,ad_user_data:this.parameters.adUserData?this.parameters.adUserData:null,ad_personalization:this.parameters.adPersonalization?this.parameters.adPersonalization:null,analytics_storage:this.parameters.analyticsStorage?this.parameters.analyticsStorage:null,functionality_storage:this.parameters.functionalityStorage?this.parameters.functionalityStorage:null,personalization_storage:this.parameters.personalizationStorage?this.parameters.personalizationStorage:null,security_storage:this.parameters.securityStorage?this.parameters.securityStorage:null};try{let c=a[2];for(const[a,d]of Object.entries(c))"granted"===d?b[a].forEach((a)=>this.profile.addConsentedObjective(a)):b[a].forEach((a)=>this.profile.addRefusedObjective(a));this.blueConicClient.profile.updateProfile()}catch(a){throw new Error(`Something happened while processing consent: ${a.message}`)}},onLoad:function(){setInterval(()=>{let a;try{a=this._getConsentEvent()}catch(a){}if(a)try{this._processConsent(a)}catch(a){}},1e3),this.blueConicClient.event.subscribe(this.consentEvent,this,function(){this._processConsent()})}});var a = [];var i='google_consent_mode_listener';blueConic.fn.registerInteractionType(i, InteractionTypeImpl, a, [{ id : i, baseUrl : blueConic.fn.getBCHostnameAwareLocalPluginsUrl() + '/plugins/google_consent_mode_listener/ts_2dad0d795c42e91e13d83f198e84f1f5/'}]);})();(function(){ var InteractionTypeImpl=InteractionType.extend({init:function(a,b){this.blueConicClient=a,this.context=b,this.parameters=b.getParameters(),this.profile=this.blueConicClient.profile.getProfile(),this.amountProcssedDataLayerEntry=0},onLoad:function(){let a=setInterval(()=>{let b;try{b=this._retrieveCheckoutData()}catch(a){}if(b){window.clearInterval(a);try{let a=this._createTimelineEventObject(b);this._publishTimelineEvent(a)}catch(a){}}},1e3)},_publishTimelineEvent:function(a){if(a){let b=new Date;this.profile.timeline.createEvent("begin_checkout",b,a);let c=this.parameters.datetimeProperty?this.parameters.datetimeProperty[0]:null,d=this.parameters.checkoutStepProperty?this.parameters.checkoutStepProperty[0]:null;c&&(this.profile.setValue(c,b),this.profile.setValue(d,"begin_checkout"),this.blueConicClient.profile.updateProfile())}},_createTimelineEventObject:function(a){let b=[],c=[],d=0,e=0,f=0,g=0;if(a&&a.products)for(let h of a.products)e=this._parseFloat(h.price),g=this._parseNumber(h.quantity),c.push(h.id),b.push({product_id:h.id,product_name:h.name,quantity:g,product_price:e,product_brand:h.brand,product_category:h.category,stock_status:h.stock_status,product_country:"",product_url:"",product_image:""}),f+=g,d+=this._parseFloat(e*g);if(0<b.length){let a=this._retrieveWebsiteContext();return this.blueConicClient.event.publish("shoppingcart",{productIds:c}),b[0].product_country=a.product_country,b[0].product_url=a.product_url,b[0].product_image=a.product_image,{label:a.label,customer_country:a.customer_country,customer_language:a.language,channel_type:a.channel,currency:a.currency,products:b,value:d,total_quantity:f,order_delivery_method:a.order_delivery_method}}},_retrieveCheckoutData:function(){let a=window.dataLayer||[],b=a.slice(this.amountProcssedDataLayerEntry);this.amountProcssedDataLayerEntry+=b.length;for(let a of b)if(a&&a.ecommerce&&a.ecommerce.checkout)return a.ecommerce.checkout},_retrieveWebsiteContext:function(){let a={label:"-",customer_country:"-",language:"-",currency:"eur",channel:"web",product_url:"-",product_image:"-",product_country:"-",order_delivery_method:"-"};try{let b=document.location.host;0<=b.indexOf("guthaben")?(a.label="guthaben.de",a.language="de"):0<=b.indexOf("beltegoed")?(a.label="beltegoed.nl",a.language="nl"):0<=b.indexOf("mobiletopup")?(a.label="mobiletopup.co.uk",a.language="en",a.currency="gbp"):0<=b.indexOf("recharge.fr")?(a.label="recharge.fr",a.language="fr"):0<=b.indexOf("recharge.com")?(a.label="recharge.com",a.language="en"):0<=b.indexOf("herladen.com")&&(a.label="herladen.com",a.language="nl");let c=window.dataLayer||[];for(let b of c)b&&b.event&&"BC_PlatformInfo"===b.event&&(a.label=b.label?b.label.toLowerCase():a.label,a.channel=b.channel_type?b.channel_type:"web",a.product_image=b.product_image?b.product_image:this._retrieveImage(),a.product_url=b.product_url?b.product_url:a.product_url),b&&b.event&&"page"===b.event&&(a.language=b.app_language?b.app_language.toLowerCase():a.language,a.product_country=b.product_country?b.product_country.toLowerCase():"-",a.customer_country=b.customer_country?b.customer_country.toLowerCase():"-",a.currency=b.purchase_currency?b.purchase_currency.toLowerCase():"eur",a.order_delivery_method=b.order_delivery_method?b.order_delivery_method.toLowerCase():"pin")}catch(a){}return a},_retrieveImage:function(){try{let a=this.parameters.imageSelector?this.parameters.imageSelector[0]:"";if(a){let b=document.querySelector(a);if(b)return b.getAttribute("src")}}catch(a){}return""},_parseNumber:function(a){try{return parseInt(a)}catch(a){}return 0},_parseFloat:function(a){try{return parseFloat(a)}catch(a){}return 0}});var a = [];var i='gtm_checkout_event_listener_new';blueConic.fn.registerInteractionType(i, InteractionTypeImpl, a, [{ id : i, baseUrl : blueConic.fn.getBCHostnameAwareLocalPluginsUrl() + '/plugins/gtm_checkout_event_listener_new/ts_dde33536d5fa9de859f865f5b8bf4f6b/'}]);})();(function(){ var InteractionTypeImpl=InteractionType.extend({init:function(a,b){this.blueConicClient=a,this.context=b,this.parameters=b.getParameters(),this.profile=this.blueConicClient.profile.getProfile(),this.amountProcessedDataLayerEntry=0},onLoad:function(){let a=setInterval(()=>{let b;try{b=this._retrieveCheckoutData()}catch(a){}if(b){window.clearInterval(a);try{let a=this._createTimelineEventObject(b);this._publishTimelineEvent(a)}catch(a){}}},1e3)},_publishTimelineEvent:function(a){if(a){let b=new Date;this.profile.timeline.createEvent("begin_checkout",b,a);let c=this.parameters.datetimeProperty?this.parameters.datetimeProperty[0]:null;c&&(this.profile.setValue(c,b),this.blueConicClient.profile.updateProfile())}},_createTimelineEventObject:function(a){if(a){let b=[],c=[],d=0,e=0,f="";if(a&&a.items){f=a.currency.toLowerCase();for(let f of a.items)c.push(f.item_id),b.push({product_id:f.item_id,product_name:f.item_name,product_price:this._parseFloat(f.price),product_brand:f.item_brand,quantity:f.quantity,product_category:f.item_category,stock_status:f.stock_status,product_country:"",product_url:"",product_image:""}),d+=f.quantity,e=parseFloat(a.value)}if(0<b.length){let a=this._retrieveWebsiteContext();return this.blueConicClient.event.publish("shoppingcart",{productIds:c}),b[0].product_country=a.product_country,b[0].product_url=a.product_url,b[0].product_image=this._retrieveImage(),{label:a.label,customer_country:a.customer_country,customer_language:a.language,channel:a.channel,currency:f,products:b,value:e,total_quantity:d,order_delivery_method:a.order_delivery_method}}}},_retrieveCheckoutData:function(){let a=window.dataLayer||[],b=a.slice(this.amountProcessedDataLayerEntry);this.amountProcessedDataLayerEntry+=b.length;for(let a of b)if(a&&"begin_checkout"===a.event&&a.ecommerce)return a.ecommerce},_retrieveWebsiteContext:function(){let a={label:"-",customer_country:"-",language:"-",currency:"eur",channel:"web",product_url:"-",product_image:"",product_country:"-",order_delivery_method:"-"};try{let b=document.location.host;0<=b.indexOf("guthaben")?(a.label="guthaben.de",a.language="de"):0<=b.indexOf("beltegoed")?(a.label="beltegoed.nl",a.language="nl"):0<=b.indexOf("mobiletopup")?(a.label="mobiletopup.co.uk",a.language="en",a.currency="gbp"):0<=b.indexOf("recharge.fr")?(a.label="recharge.fr",a.language="fr"):0<=b.indexOf("recharge.com")?(a.label="recharge.com",a.language="en"):0<=b.indexOf("herladen.com")&&(a.label="herladen.com",a.language="nl");let c=window.dataLayer||[];for(let b of c)b&&b.event&&"BC_PlatformInfo"===b.event&&(a.label=b.label?b.label.toLowerCase():a.label,a.channel=b.channel_type?b.channel_type:"web",a.product_image=b.product_image?b.product_image:"-",a.product_url=b.product_url?b.product_url:a.product_url),b&&b.event&&"page"===b.event&&(a.language=b.app_language?b.app_language.toLowerCase():a.language,a.product_country=b.product_country?b.product_country.toLowerCase():"-",a.customer_country=b.customer_country?b.customer_country.toLowerCase():"-",a.currency=b.purchase_currency?b.purchase_currency.toLowerCase():"eur",a.order_delivery_method=b.order_delivery_method?b.order_delivery_method.toLowerCase():"pin")}catch(a){}return a},_retrievePlatformInfoData:function(){let a=window.dataLayer||[],b=a.slice(this.amountProcessedDataLayerEntry);this.amountProcessedDataLayerEntry+=b.length;for(let a of b)if(a&&"BC_platform_info"===a.event)return a},_retrieveImage:function(){try{let a=this.parameters.imageSelector?this.parameters.imageSelector[0]:"";if(a){let b=document.querySelector(a);if(b)return window.location.origin+b.getAttribute("src")}}catch(a){}return""},_parseFloat:function(a){try{return parseFloat(a)}catch(a){}return 0},_parseNumber:function(a){try{return parseInt(a)}catch(a){}return 0}});var a = [];var i='gtm_checkout_event_listener_v2';blueConic.fn.registerInteractionType(i, InteractionTypeImpl, a, [{ id : i, baseUrl : blueConic.fn.getBCHostnameAwareLocalPluginsUrl() + '/plugins/gtm_checkout_event_listener_v2/ts_988091d97fcefb3166597a96b28a8e0c/'}]);})();(function(){ var InteractionTypeImpl;(()=>{"use strict";var t,e,i,n,o,s={d:(t,e)=>{for(var i in e)s.o(e,i)&&!s.o(t,i)&&Object.defineProperty(t,i,{enumerable:!0,get:e[i]})},o:(t,e)=>Object.prototype.hasOwnProperty.call(t,e)},a={};s.d(a,{default:()=>c}),(o=t||(t={})).SEGMENT="segment",o.LIFECYCLE="lifecycle",o.PROPERTY="property",o.TEXT="text",o.STORE="store",o.EMPTY="empty",o.GROUP="group",o.TIMELINE_EVENT="timelineEvent",o.EXPORT_DATA_PROCESSOR="exportDataPreprocessor",o.GROUP_PROPERTY="groupProperty",(n=e||(e={})).FIXED="fixed",n.SEGMENT="segment",n.SEGMENTS="segments",n.LIFECYCLES="lifecycles",n.PROPERTY="property",n.UNIQUE_PROPERTY="uniqueproperty",n.GROUP_PROPERTY="groupProperty",n.PROPERTY_SOURCE_TENANT="propertySourceTenant",n.GROUP_ID="groupId",n.TEXT="text",n.STORE="store",n.PROFILE_ID="profileid",n.PERMISSION="permission",n.ALL_INTERACTIONS="allInteractions",n.PAGEVIEW_INTERACTIONS="pageviewInteractions",n.TIMELINE_EVENT_TYPE="timeline_event_type",n.TIMELINE_EVENT="timelineEvent",n.TIMELINE_EVENT_CLEANROOM="timelineEventCleanroom",n.TIMELINE_DATE_ID="timelineDateId",n.TIMELINE_EVENT_ID="timelineEventId",n.TIMELINE_PROPERTY="timelineProperty",n.PLUGIN="plugin",n.EXPORT_DATA_PROCESSOR="exportDataPreprocessor",function(t){t.SET_OR_CLEAR="setOrClear",t.ADD="add",t.SUM="sum",t.SET_IF_EMPTY="setIfEmpty",t.SET="set"}(i||(i={}));const r=Object.freeze({SETUP:"setup",IMPORT:"import",EXPORT:"export"}),l=(e.PROPERTY,e.PROFILE_ID,e.SEGMENTS,e.LIFECYCLES,e.PAGEVIEW_INTERACTIONS,e.PERMISSION,e.TEXT,"gtmpf");class c extends InteractionType{init(t,e){this.blueConicClient=t,this.context=e||null,this.profile=this.context.getProfile(),this.parameters=this.context.getParameters(),this.objectName=this.getObjectName(this.parameters.goalParameters),this._goals=[];const i=e.getGoals().reduce((function(t,e){return t[e.getId()]=!0,t}),{});if(this.parameters.goalParameters)for(const t of this.parameters.goalParameters){const e=this.blueConicClient.json.parse(t);e.active&&i[e.id]&&this._goals.push(e)}this.connectionContext={LAST_PUSH_PROPERTY:l+"lt"+this.context.getInteractionId(),VARIABLE_STATE_PUSH_PROPERTY:l+"st"+this.context.getInteractionId(),profile:this.profile,variables:[],SENT_TO_SYSTEM_PROPERTY:"sent_to_system",SENT_TO_CONNECTION_PROPERTY:"sent_to_connection",RECEIVED_FROM_SYSTEM_PROPERTY:"received_from_system",RECEIVED_FROM_CONNECTION_PROPERTY:"received_from_connection"}}initDataLayerUtil(){this.bcConnectionUtil.md5Lib=this.md5,this._bcDatalayerUtil=new this.BlueConicDataLayerUtility(this.objectName,this.blueConicClient,this.bcConnectionUtil,this.context,this.connectionContext,this.profile),this._bcDatalayerUtil.LAST_PUSH_PROPERTY=l+"lt"+this.context.getInteractionId(),this._bcDatalayerUtil.VARIABLE_STATE_PUSH_PROPERTY=l+"st"+this.context.getInteractionId();const t=this;this.blueConicClient.event.subscribe(this.blueConicClient.event.onUrlChange,this,(function(){t._bcDatalayerUtil.stopDataLayerInspection()}))}onLoad(){return new Promise((t=>{this.initDataLayerUtil();let e=0;const i=async()=>{if(this._bcDatalayerUtil.getDataLayer())await this._handleGoals(),t();else{if(e>20)return void t();e++,window.setTimeout(i,250)}};i.call(this)}))}async loadTimelineEventTypes(){var t;const e=[],i=this.blueConicClient.getRestEndpoint(this.context.getInteractionTypeId())+"/timelineEventTypePropertyTypes";for(const i of this._goals)i.categoryId===r.IMPORT&&(null===(t=i.state.importEventMapping)||void 0===t?void 0:t.length)&&e.push(...i.state.importEventMapping.map((t=>t.eventTypeId)).filter((t=>t.length>0)));await this._bcDatalayerUtil.loadTimelineEventTypeProperties(e,i)}async _handleGoals(){var t;await this.loadTimelineEventTypes();for(const e of this._goals){const i=null===(t=null==e?void 0:e.state)||void 0===t?void 0:t.segment;this._bcDatalayerUtil.visitorInSegment(i)&&(e.categoryId===r.EXPORT&&this._handleExportGoal(e.state,e.id),e.categoryId===r.IMPORT&&this._handleImportGoal(e.state,e.id))}}_handleImportGoal(t,e){let i=this._bcDatalayerUtil.getDataLayer();if(!i)return;this._bcDatalayerUtil.doImport(t,e),this._publishEvents();let n=i.length;window.setInterval((()=>{i=this._bcDatalayerUtil.getDataLayer(),n!==i.length&&(this._publishEvents(n),n=i.length)}),1e3)}_publishEvents(t){var e;const i=this._bcDatalayerUtil.getDataLayer();if(t=t||0,Array.isArray(i))for(let n=t;n<i.length;n++){const t=null===(e=null==i?void 0:i[n])||void 0===e?void 0:e.event;t&&this.blueConicClient.event.publish("GTM:"+t,[i[n]])}}_handleExportGoal(t,e){this._bcDatalayerUtil.doExport(t,e),!window[this.objectName]||window[this.objectName].push?(t.pushInteractions&&this.blueConicClient.event.subscribe("VIEW",this,this._pushInteractionView),t.passOnEvents&&this._subscribeToPassOnEvents()):console.warn("window."+this.objectName+" does not have a push function: is the correct Object Name entered?")}getPreloadProperties(){var t,e,i,n;const o=[null===(t=this.connectionContext)||void 0===t?void 0:t.SENT_TO_SYSTEM_PROPERTY,null===(e=this.connectionContext)||void 0===e?void 0:e.SENT_TO_CONNECTION_PROPERTY,null===(i=this.connectionContext)||void 0===i?void 0:i.RECEIVED_FROM_SYSTEM_PROPERTY,null===(n=this.connectionContext)||void 0===n?void 0:n.RECEIVED_FROM_CONNECTION_PROPERTY];for(const t of this._goals)t.categoryId===r.EXPORT?o.push(...this._setPreloadPropertiesExport(t)):t.categoryId===r.IMPORT&&o.push(...this._setPreloadPropertiesImport(t));return o}_setPreloadPropertiesExport(e){const i=[];if(i.push(l+"st"+this.context.getInteractionId()+"_"+e.id),i.push(l+"lt"+this.context.getInteractionId()+"_"+e.id),e.state.exportMapping)for(const n of e.state.exportMapping)n.from.dataType===t.PROPERTY&&n.from.values.length>0&&i.push(n.from.values[0].id);return i}_setPreloadPropertiesImport(t){const e=[];if(t.state.importMapping)for(const i of t.state.importMapping)i.to.values.length>0&&e.push(i.to.values[0].id);return e}_pushInteractionView(t,e){const i=this.blueConicClient.getInteractionNamesById(e);if(null===i)return;const n=i.variantName?i.name+" / "+i.variantName:i.name;window[this.objectName].push({event:"bcInteractionView",name:n})}_subscribeToPassOnEvents(){const t=[["inactivity","Inactivity"],["exitintent","Exit Intent"],["cm_firstview","Content Meter View 1"],["cm_exceeded","Content Meter Exceeded"],["cm_lastview","Content Meter Last View"],["cm_excluded","Content Meter Excluded View"],["cm_bottom","Content Meter Bottom Range"],["cm_middle","Content Meter Middle Range"],["cm_top","Content Meter Top Range"],["cm_already_viewed","Content Meter Already Viewed"],["cm_free_view","Content Meter Free View"],["cm_last_free_view","Content Meter Last Free View"]];let e;for(e=2;e<10;e++)t.push(["cm_view_"+e,"Content Meter View "+e]);for(e=1;e<10;e++)t.push(["cm_free_view_"+e,"Content Meter Free View "+e]);t.forEach((t=>{this.blueConicClient.event.subscribe(t[0],this,(()=>{window[this.objectName].push({event:"bcEvent",bcEventName:t[1]})}))}))}getObjectName(t){var e;const i=this.getSetupGoal(t);return(null===(e=null==i?void 0:i.state)||void 0===e?void 0:e.objectName)||"dataLayer"}getSetupGoal(t){var e;return null===(e=t.map((t=>JSON.parse(t))).filter((t=>t.categoryId===r.SETUP)))||void 0===e?void 0:e[0]}}InteractionTypeImpl=a.default})();var a = [];var i='gtmconnection';a.push({url: blueConic.fn.getBCHostnameAwarePluginsRepositoryUrl(ps, pf) + i + '/4.0.9/web/node_modules/@blueconic/connection_lib/connection_lib.js', sharing: 'local'});a.push({url: blueConic.fn.getBCHostnameAwarePluginsRepositoryUrl(ps, pf) + i + '/4.0.9/web/node_modules/@blueconic/datalayer-library/dist/index.js', sharing: 'local'});a.push({url: blueConic.fn.getBCHostnameAwarePluginsRepositoryUrl(ps, pf) + i + '/4.0.9/web/src/web/lib/md5.min.js', sharing: 'local'});blueConic.fn.registerInteractionType(i, InteractionTypeImpl, a, [{ id : i, baseUrl : blueConic.fn.getBCHostnameAwarePluginsRepositoryUrl(ps, pf) + i + '/4.0.9/'}]);})();(function(){ var InteractionTypeImpl=InteractionType.extend({init:function(a,b){this.blueConicClient=a,this.context=b,this.profile=this.blueConicClient.profile.getProfile(),this.dateIsNotAdded=!0},getPreloadProperties:function(){return["gtm_events","checkout_step","currentcheckout_step","checkout_date","currentcheckout_date","last_order_date","order_count_total"]},onLoad:function(){this.blueConicClient.event.subscribe("GTM:checkout",this,function(){this.writeValueToProperty()}),this.blueConicClient.event.subscribe("GTM:checkout_email",this,function(){this.writeValueToProperty()}),this.blueConicClient.event.subscribe("GTM:checkout_selectpayment",this,function(){this.writeValueToProperty()}),this.blueConicClient.event.subscribe("GTM:checkout_startpayment",this,function(){this.writeValueToProperty()}),this.blueConicClient.event.subscribe("GTM:purchase",this,function(){this.writeValueToProperty()}),this.blueConicClient.event.subscribe("GTM:add_to_cart",this,function(){this.writeValueToProperty()}),this.blueConicClient.event.subscribe("GTM:product_detail",this,function(){this.writeValueToProperty()}),this.blueConicClient.event.subscribe("GTM:product_impressions",this,function(){this.writeValueToProperty()})},writeValueToProperty:function(){var a=new Date,b=this.profile.getValues("gtm_events"),c=b.filter((a)=>a.includes("checkout")||a.includes("Platform - WEB")||a.includes("product_")||a.includes("add_to_cart")||a.includes("purchase"));if(0<c.length){var d=c[c.length-1],e=this.profile.getValue("currentcheckout_step")!==d,f=this.profile.getValue("currentcheckout_date")<=a.getTime()-60000;this.dateIsNotAdded&&f&&(this.profile.addValue("checkout_date",a),this.dateIsNotAdded=!1),(e||f)&&this.profile.setValue("currentcheckout_date",a),(e||f)&&this.profile.setValue("currentcheckout_step",d),c.forEach((a)=>{this.profile.addValue("checkout_step",a)}),c.includes("purchase")&&(this.profile.setValue("last_order_date",a),this.profile.incrementValue("order_count_total","1")),this.blueConicClient.profile.updateProfile()}}});var a = [];var i='gtmvalueconverterlistener';a.push({url: 'http://code.jquery.com/jquery-1.11.2.min.js', sharing: 'local'});blueConic.fn.registerInteractionType(i, InteractionTypeImpl, a, [{ id : i, baseUrl : blueConic.fn.getBCHostnameAwareLocalPluginsUrl() + '/plugins/gtmvalueconverterlistener/ts_885e35670a190af1888fb9079eef73b2/'}]);})();(function(){ var InteractionTypeImpl=InteractionType.extend({_timeout:null,_timestamp:null,_interval:200,init:function(t,e){this.blueConicClient=t,this.context=e||null},onLoad:function(){var t=this;this.blueConicClient.event.subscribe(this.blueConicClient.event.onUrlChange,this,(function(e,i){this._setTimestamp(),clearTimeout(t._timeoutID),t._timeoutID=setTimeout((function(){t._checkTimeout()}),t._interval)})),this._setTimestamp();var e,i=this.context.getParameters(),n="true"===i.clicks[0],o="true"===i.inputs[0];if(e=!i.scrolling||"true"===i.scrolling[0],this._timeout=i.timeout[0],this._timeout?isNaN(parseInt(this._timeout))||(this._timeout=1e3*parseInt(this._timeout)):this._timeout=6e4,n||o||e){if(n&&document.addEventListener("click",(function(){t._setTimestamp()})),o){var c=document.querySelectorAll("input"),s=document.querySelectorAll("textarea"),u=document.querySelectorAll("select");Array.prototype.forEach.call(c,(function(e){e.addEventListener("keyup",(function(){t._setTimestamp()}))})),Array.prototype.forEach.call(c,(function(e){e.addEventListener("change",(function(){t._setTimestamp()}))})),Array.prototype.forEach.call(s,(function(e){e.addEventListener("keyup",(function(){t._setTimestamp()}))})),Array.prototype.forEach.call(u,(function(e){e.addEventListener("change",(function(){t._setTimestamp()}))}))}e&&window.addEventListener("scroll",(function(){t._setTimestamp()})),this._timeoutID=setTimeout((function(){t._checkTimeout()}),t._interval)}},_handleInactivity:function(){this.blueConicClient.createEvent("inactivity")},_checkTimeout:function(){var t=(new Date).getTime(),e=this;t-this._timestamp>this._timeout?this._handleInactivity():e._timeoutID=setTimeout((function(){e._checkTimeout()}),e._interval)},_setTimestamp:function(){this._timestamp=(new Date).getTime()}});var a = [];var i='inactivitylistener';blueConic.fn.registerInteractionType(i, InteractionTypeImpl, a, [{ id : i, baseUrl : blueConic.fn.getBCHostnameAwarePluginsRepositoryUrl(ps, pf) + i + '/1.2.0/'}]);})();(function(){ var InteractionTypeImpl=InteractionType.extend({init:function(a,b){this.blueConicClient=a,this.interaction=b},onLoad:function(){var a=this.interaction.getProfile(),b=this.interaction.getParameters(),c=b.ip_range_rules?b.ip_range_rules[0]:b.ip_range_rules,d=b.property?b.property[0]:b.property,e=this.blueConicClient.getIPAddress();if(c&&d&&e&&(c=this.blueConicClient.json.parse(c),0!==c.length)){for(var f=!1,g=0;g<c.rules.length;g++){var h=c.rules[g],i=h.lowest,k=h.highest,l=h.addset,m=h.values;if(i&&k&&m&&0<m.length){var n,o,p;if(1<i.split(":").length&&1<k.split(":").length&&1<e.split(":").length?(n=this.ip2num(this.ip6hexToNumber(e)),o=this.ip2num(this.ip6hexToNumber(i)),p=this.ip2num(this.ip6hexToNumber(k))):(n=this.ip2num(e),o=this.ip2num(i),p=this.ip2num(k)),n<=p&&n>=o)if(f=!0,"add"===l)for(var q=0;q<m.length;q++)a.addValue(d,m[q]);else a.setValues(d,m)}}f&&this.blueConicClient.profile.updateProfile()}},ip2num:function(b){var c=b.split(".");0===c.length&&(c=b.split(":")),4===c.length&&c.unshift(0,0,0,0);var d=256*(256*(256*(256*(256*(256*(256*+c[0]+ +c[1])+ +c[2])+ +c[3])+ +c[4])+ +c[5])+ +c[6])+1*+c[7];return d},ip6hexToNumber:function(a){for(var b=a.split(":"),c=[],d=0;d<b.length;d++)if(""===b[d])for(var e=0;e<=8-b.length;e++)c.push(0);else c.push(parseInt(b[d],16));return c.join(".")}});var a = [];var i='iplistenerinteractiontype';blueConic.fn.registerInteractionType(i, InteractionTypeImpl, a, [{ id : i, baseUrl : blueConic.fn.getBCHostnameAwarePluginsRepositoryUrl(ps, pf) + i + '/2.0.8/'}]);})();(function(){ var InteractionTypeImpl=InteractionType.extend({init:function(t,e){this.blueConicClient=t,this.context=e,this.parameters=this.context.getParameters(),this.isInEditMode=this.blueConicClient.isInEditMode(),this.fancyBoxLib="frontend/src/lib/fancybox/jquery.fancybox.pack.js";var n=this.context.getInteractionTypeId();this.baseURL=this.blueConicClient.getBaseURL(n);var i=this.parameters.content+"";this.htmlFragment=this.createElement(i),this.profile=t.profile.getProfile(),this.inlineCss=null,this._timestamp=null,this._observer=null,this._eventListenerFunction=null,this._lightboxTriggered=!1,this.blueConicClient._renderedInteractions=this.blueConicClient._renderedInteractions||[],this.blueConicClient.event.subscribe(this.blueConicClient.event.onUrlChange,this,(function(){var t=this.blueConicClient.util.array.indexOfArray(this.blueConicClient._renderedInteractions,this.context.getInteractionId());this.blueConicClient._renderedInteractions.splice(t,1)}))},getPreloadProperties:function(){for(var t,e=this.context.getParameters().content+"",n=/data-bc-preload="([^"]*)"/g,i=[];null!==(t=n.exec(e));)for(var o=t[1].split(","),r=0;r<o.length;r++)i.push(o[r]);for(var a=this.htmlFragment?this._getPropertiesFromPlaceholders(this.htmlFragment.innerHTML):[],c=0;c<i.length;c++)a.push(i[c]);return a},onMessageReceived:function(t){this.blueConicClient.event.publish("lightbox.messageReceived",t)},onLoad:function(){window.bc=window.bc||{},window.bc.jQuery=this.jQuery,window.bc.$=this.jQuery,window.bcFancyboxLoading?this.blueConicClient.event.subscribe("bcFancyboxLoaded",this,(function(){this.onLoad()})):this.blueConicClient._lightboxinteractiontypeFancybox?(this.jQuery.fancybox=this.blueConicClient._lightboxinteractiontypeFancybox,this._onLoadWithLibrary()):(window.bcFancyboxLoading=!0,this.blueConicClient.util.loadScript(this.baseURL+this.fancyBoxLib,this,(function(){this.blueConicClient._loadLightboxInteractionTypeFancyBox(window,document,this.jQuery),this.blueConicClient._lightboxinteractiontypeFancybox=this.jQuery.fancybox,delete this.blueConicClient._loadLightboxInteractionTypeFancyBox,this._onLoadWithLibrary(),window.bcFancyboxLoading=!1,this.blueConicClient.event.publish("bcFancyboxLoaded")})))},_onLoadWithLibrary:function(){if(this.isInEditMode)this.showLightbox();else{var t=this.parameters.selected_when||[],e=this.getParameter("click_selector");e&&-1!==this.blueConicClient.util.array.indexOfArray(t,"click_selector")&&this._addClickTriggerBindings(e);var n=this.getParameter("content_condition");n&&-1!==this.blueConicClient.util.array.indexOfArray(t,"content_condition")&&this._addContentPolling(n);var i=this.parameters.scroll_depth&&this.parameters.scroll_depth[0]&&!isNaN(this.parameters.scroll_depth[0])?parseInt(this.parameters.scroll_depth[0]):0;i&&-1!==this.blueConicClient.util.array.indexOfArray(t,"scroll_depth")&&this._addScrollBinding(i),0===t.length&&this.showLightbox(),this._addCloseEventHandler()}},_getScrollPercent:function(){return document.documentElement.scrollTop/(document.documentElement.scrollHeight-window.innerHeight)*100},_checkScrollCondition:function(t){this._getScrollPercent()>=t&&this.showLightbox()},_addScrollBinding:function(t){this._checkScrollCondition(t),document.addEventListener("scroll",function(){this._checkScrollCondition(t)}.bind(this))},_addClickTriggerBindings:function(t){try{var e=this.jQuery(t);e.length>0?e.off("click.lightboxinteractiontype").on("click.lightboxinteractiontype",this.jQuery.proxy((function(){this.showLightbox(!0)}),this)):this.blueConicClient.position.subscribe(t,this,this.jQuery.proxy(this._addClickTriggerBindings,this,t))}catch(n){}},_addContentPolling:function(t){this._checkContentCondition(t);var e=this,n=document.getElementsByTagName("body")[0];if(window.MutationObserver||window.WebKitMutationObserver||window.MozMutationObserver)this._observer=new MutationObserver((function(){e._observeContentChanges(t)})),this._observer.observe(n,{childList:!0,subtree:!0});else if(window.addEventListener)this._eventListenerFunction=function(){e._observeContentChanges(t)},n.addEventListener("DOMNodeInserted",this._eventListenerFunction,!1);else var i=setInterval((function(){e._lightboxTriggered?clearInterval(i):e._checkContentCondition(t)}),500)},_observeContentChanges:function(t){if(this._lightboxTriggered){this._observer?this._observer.disconnect():document.getElementsByTagName("body")[0].removeEventListener("DOMNodeInserted",this._eventListenerFunction,!1)}else{var e=this,n=(new Date).getTime();this._timestamp=n,setTimeout((function(){e._timestamp!==n||e._lightboxTriggered||e._checkContentCondition(t)}),250)}},_checkContentCondition:function(t){this.jQuery(t).length>0&&this.jQuery(t).html()&&this.jQuery(t).html().length>0&&this.showLightbox()},closeLightbox:function(){this.isInEditMode||this.jQuery.fancybox.close()},_addCloseEventHandler:function(){this.blueConicClient.event.subscribe("closeoverlay",this,(function(t,e){e instanceof Array&&e[0]===this.context.getInteractionId()&&this.closeLightbox()}))},showLightbox:function(t){if(-1===this.blueConicClient.util.array.indexOfArray(this.blueConicClient._renderedInteractions,this.context.getInteractionId())&&(!this._lightboxTriggered||this.isInEditMode||t)){this.blueConicClient._renderedInteractions.push(this.context.getInteractionId());var e=this.parameters.delay&&this.parameters.delay[0]&&!isNaN(this.parameters.delay[0])?1e3*parseInt(this.parameters.delay[0]):0;!this.isInEditMode&&e>0?window.setTimeout(this._showLightbox.bind(this),e):this._showLightbox()}},getSettings:function(){var t=null,e=this.getParameter("width")||null,n=this.getParameter("height")||null,i="true"===this.getParameter("hide_after_close");this.htmlFragment&&(t=this.htmlFragment.innerHTML);var o=!(e||n),r=this.getParameter("show_close"),a=this.getParameter("alternative_close"),c={parent:"body",autoSize:o,autoCenter:!1,autoWidth:!e,autoHeight:!n,closeBtn:"false"!==r,width:e||"auto",height:n||"auto",keys:{close:"false"===a||this.isInEditMode?null:[27]},helpers:{overlay:{locked:!0,closeClick:"false"!==a&&!this.isInEditMode,speedOut:0}}};this.getParameter("template")&&(c.padding=0),(t||this.isInEditMode)&&(c.content=" ",c.type="inline");var s=this,l=this.jQuery,h=this.getParameter("effect"),d=this.getParameter("effect_slide_direction")||"left";if(this.isInEditMode&&(h="noEffect"),h&&"noEffect"!==h&&("fadeIn"===h?l.fancybox.transitions.openEffect=function(){var t=l.fancybox._getPosition(!0);t.opacity=0,l.fancybox.wrap.css(t).show().animate({opacity:1},{duration:l.fancybox.current.openSpeed,complete:l.fancybox._afterZoomIn})}:"slideIn"===h&&(l.fancybox.transitions.openEffect=function(){var t,e=l.fancybox._getPosition(!0),n=window.innerHeight,i=window.innerWidth,o=l.fancybox.current.wrap[0].getBoundingClientRect(),r="top"===d||"bottom"===d?"top":"left";"top"===d||"bottom"===d?t=n-(n-o.height)/2:"left"!==d&&"right"!==d||(t=i-(i-o.width)/2),e[r]="top"===d||"left"===d?parseInt(e[r])-t+"px":parseInt(e[r])+t+"px";var a={},c="top"===d||"left"===d?"+":"-";a[r]=c+"="+t+"px",l.fancybox.wrap.css(e).show().animate(a,{duration:l.fancybox.current.openSpeed,complete:l.fancybox._afterZoomIn})}),l.fancybox.transitions.openEffect&&(c.openMethod="openEffect",c.openSpeed=600)),t)c.afterLoad=function(t){s.emptyElementsWithAttribute(s.htmlFragment,"div","data-bc-external");try{t.inner.html(s.htmlFragment.innerHTML)}catch(n){console.error("[BC] Error occured when injecting the HTML in the DOM",n)}s.isInEditMode&&s.blueConicClient.event.publish("lightbox.interactionLoaded",{interaction:s}),s.handleComplexElements(t.inner[0]);var e=s.getParameter("javascript");if(e&&!s.blueConicClient.isInEditMode()){e=e.replace(/(^|\W)blueConicVariantId(\W|$)/g,'$1"'+s.context.getInteractionId()+'"$2'),s._inlineJs=s.jQuery("<script>"+e+"<\/script>");try{s._inlineJs.appendTo(s.jQuery("body"))}catch(n){console.error(n)}}};else if(s.isInEditMode){c.afterLoad=function(){s.blueConicClient.event.publish("lightbox.interactionLoaded",{interaction:s})}}return this.isInEditMode?c.afterShow=function(){l(".fancybox-close").off("click.fb")}:i&&(c.afterShow=function(){Array.prototype.forEach.call(document.querySelectorAll(".fancybox-close"),(function(t){t.addEventListener("click",(function(){s.blueConicClient.doNotShowAgain(s.context.getInteractionId())}))}))}),c.afterClose=function(){var t=s.blueConicClient.util.array.indexOfArray(s.blueConicClient._renderedInteractions,s.context.getInteractionId());s.blueConicClient._renderedInteractions.splice(t,1)},c},updateLightbox:function(){this.jQuery.fancybox.update()},getCurrentFancyBox:function(){return this.jQuery.fancybox.current},_showLightbox:function(){this._lightboxTriggered=!0;var t=this.getParameter("close_icon"),e=this.getParameter("close_icon_hover"),n=this,i=this.jQuery;function doLightBox(){if(!this.isInEditMode){this.blueConicClient.createEvent("VIEW",this.context.getInteractionId()),!!this.parameters.forceclick&&("true"===this.parameters.forceclick[0]||!0===this.parameters.forceclick[0])&&this.blueConicClient.createEvent("CLICK",this.context.getInteractionId());var t=this.getParameter("click_event_selector");if(t){this.jQuery("body").one("click",t,function(t){this.lastClickEvent&&this.lastClickEvent.originalEvent===t.originalEvent||this._logClickEvent(t)}.bind(this));try{this.jQuery(t).one("click",function(t){this.lastClickEvent=t,this._logClickEvent(t)}.bind(this))}catch(i){}}}Array.prototype.forEach.call(document.querySelectorAll(".fancybox-wrap"),(function(t){t.parentNode.removeChild(t)})),Array.prototype.forEach.call(document.querySelectorAll(".fancybox-overlay"),(function(t){t.parentNode.removeChild(t)}));var e=function findHighestZIndex(t){var e,n=document.getElementsByTagName(t),i=0,o=0;for(o=0;o<n.length;o++)"auto"!==(e=document.defaultView.getComputedStyle(n[o],null).getPropertyValue("z-index"))&&parseInt(e)>i&&(i=parseInt(e));return i}("*");this.htmlFragment&&(this.emptyElementsWithAttribute(this.htmlFragment,"div","data-bc-external"),this.isInEditMode||this.handlePlaceholders(this.htmlFragment)),this.jQuery.fancybox(this.getSettings());var n=2147483647;e>8e3&&e+1030<n&&(Array.prototype.forEach.call(document.querySelectorAll(".fancybox-opened"),(function(t){t.style.zIndex=e+1030})),Array.prototype.forEach.call(document.querySelectorAll(".fancybox-wrap"),(function(t){t.style.zIndex=e+920})),Array.prototype.forEach.call(document.querySelectorAll(".fancybox-overlay"),(function(t){t.style.zIndex=e+910}))),e+1030>=n&&(Array.prototype.forEach.call(document.querySelectorAll(".fancybox-opened"),(function(t){t.style.zIndex=n})),Array.prototype.forEach.call(document.querySelectorAll(".fancybox-wrap"),(function(t){t.style.zIndex=2147483646})),Array.prototype.forEach.call(document.querySelectorAll(".fancybox-overlay"),(function(t){t.style.zIndex=2147483645}))),this.isInEditMode||this._setupFrontEndBindings()}this.handleStyling(t,e,(function(t){if(!t||(console.error(t),n.isInEditMode))n.handleJavascript().then((function(){doLightBox.call(n,i)}),(function(t){if(console.error("[BC] Loading Javascript urls for the lightbox failed:",t),n.isInEditMode)doLightBox.call(n,i);else{var e=n.blueConicClient.util.array.indexOfArray(n.blueConicClient._renderedInteractions,n.context.getInteractionId());n.blueConicClient._renderedInteractions.splice(e,1)}}));else{var e=n.blueConicClient.util.array.indexOfArray(n.blueConicClient._renderedInteractions,n.context.getInteractionId());n.blueConicClient._renderedInteractions.splice(e,1)}}))},_logClickEvent:function(t){t&&t.originalEvent&&t.originalEvent._blueConicLoggedClickEvent===this.context.getInteractionId()||(t&&t.target&&t.target.pathname&&t.target.hostname&&0===t.target.pathname.indexOf("/s/")&&-1!==t.target.hostname.indexOf("blueconic")||(t.originalEvent&&(t.originalEvent._blueConicLoggedClickEvent=this.context.getInteractionId()),this.blueConicClient.createEvent("CLICK",this.context.getInteractionId())))},_setupFrontEndBindings:function(){var t=this.jQuery(".bcLightboxDontShowAgainLink"),e=this.jQuery(".bcLightboxCloseButton");t.length>0&&t.off("click.dontShowAgainLinks").on("click.dontShowAgainLinks",function(t){t.preventDefault(),this.blueConicClient.doNotShowAgain(this.context.getInteractionId()),this.closeLightbox()}.bind(this)),e.length>0&&e.off("click.closeButtons").on("click.closeButtons",function(){this.closeLightbox()}.bind(this))},handleComplexElements:function(t){for(var e=this.getElementsWithAttribute(t,"div","data-bc-pluginid"),n=0;n<e.length;n++){var i=e[n],o=i.getAttribute("data-bc-pluginid"),r=i.getAttribute("data-bc-config");if(r)try{var a=r.replace(/\n/g,"\\\\n").replace(/\r/g,"\\\\r").replace(/\t/g,"\\\\t");r=this.blueConicClient.json.parse(a)}catch(c){r=null}this.blueConicClient.event.publish("bcComplexObject",{plugin:o,config:r,node:i,interactionId:this.context.getInteractionId()}),this.isInEditMode||(i.removeAttribute("data-bc-pluginid"),i.removeAttribute("data-bc-config"))}},emptyElementsWithAttribute:function(t,e,n){for(var i=this.getElementsWithAttribute(t,e,n),o=0,r=i.length;o<r;o++){i[o].innerHTML=""}},getElementsWithAttribute:function(t,e,n){for(var i=[],o=t.getElementsByTagName(e),r=0,a=o.length;r<a;r++){var c=o[r];c.getAttribute(n)&&i.push(c)}return i},createElement:function(t){var e;if(!t)return null;try{(e=document.createElement("div")).innerHTML=t}catch(n){return null}return e},handlePlaceholders:function(t){for(var e=this._getPropertiesFromPlaceholders(t.innerHTML),n=0;n<e.length;n++){var i=e[n],o=this.profile.getValue(i)||"",r=new RegExp("\\$\\{"+i+"\\}","g");t.innerHTML=t.innerHTML.replace(r,encodeURI(o))}},_getPropertiesFromPlaceholders:function(t){for(var e,n=/\$\{([a-zA-Z\-_0-9]+)\}/g,i=[];e=n.exec(t);)i.push(e[1]);return i},getParameter:function(t){return this.parameters[t]&&this.parameters[t][0]?this.parameters[t][0]:null},getParameters:function(t){return this.parameters[t]||null},handleJavascript:function(){var t=this.jQuery,e=this.getParameters("javascript_urls"),n=[];if(e){this.javascriptUrls=e;for(var i=0;i<e.length;i++)n.push(this._getLoadScriptDeferred(e[i]))}return t.when.apply(t,n)},_getLoadScriptDeferred:function(t){var e=this.jQuery.Deferred(),n=document.createElement("script");return n.setAttribute("src",t),n.onload=function(){e.resolve()},n.onerror=function(){e.reject('Url "'+t+"\" couldn't be loaded")},document.head.appendChild(n),e},handleStyling:function(t,e,n){var i=this.getParameter("content"),o=[this.baseURL+"frontend/src/lib/fancybox/jquery.fancybox.css"];i&&-1!==i.indexOf("bcLightboxTemplate")||o.push(this.baseURL+"frontend/src/css/lightbox.css");var r=this.getParameter("styling_css");r&&(this.stylingUrl=r,o.push(r));var a="";"true"===this.getParameter("custom_close")&&t&&(a+=".fancybox-close {background-image: url('"+t+"');background-repeat: no-repeat;background-position: center center;background-size: contain;}",e&&(a+=".fancybox-close:hover {background-image: url('"+e+"');background-repeat: no-repeat;background-position: center center;background-size: contain;}"));var c=this.getParameter("close_position"),s=this.getParameter("close_padding");a+=this._getClosePositionStyling(c,s);var l=this.getParameter("styling_css_inline");return l&&(a+=l.replace(/&#xd;/gi,"")),a&&(this.inlineCss=this.jQuery("<style>"+a+"</style>"),this.inlineCss.appendTo(this.jQuery("body"))),this._loadCssUrls(o,n)},_loadCssUrls:function(t,e){var n=(t=t||[]).length,i=0,o=[];if(0===n)return e();function urlLoaded(){if(++i>=n)return o.length>0?e(o):e()}t.forEach((function(t){if(document.querySelector('link[href="'+t+'"]'))urlLoaded();else{var e=document.createElement("link");e.setAttribute("rel","stylesheet"),e.setAttribute("href",t),e.onload=urlLoaded,e.onerror=function(t){o.push(t),urlLoaded()},document.head.appendChild(e)}}))},_getClosePositionStyling:function(t,e){if(!t)return"";null!==e&&"NaN"!==e||(e="-18");var n=".fancybox-close {";switch(t){case"TOP_LEFT":n+="top:"+e+"px; right: unset; bottom: unset; left:"+e+"px;";break;case"BOTTOM_RIGHT":n+="top: auto; right: "+e+"px; bottom: "+e+"px; left: unset;";break;default:n+="top: "+e+"px; right: "+e+"px; bottom: unset; left: unset;"}return n+"}"}});var a = [];var i='lightboxinteractiontype';a.push({url: blueConic.fn.getBCHostnameAwarePluginsRepositoryUrl(ps, pf) + i + '/2.6.0/frontend/src/node_modules/@blueconic/jquery-x-jquerymigrate/load_jQuery3_7_X_jQueryMigrate.min.js', sharing: 'local'});blueConic.fn.registerInteractionType(i, InteractionTypeImpl, a, [{ id : i, baseUrl : blueConic.fn.getBCHostnameAwarePluginsRepositoryUrl(ps, pf) + i + '/2.6.0/'},{ id : 'html', baseUrl : blueConic.fn.getBCHostnameAwarePluginsRepositoryUrl(ps, pf) + 'html/1.0.10/'},{ id : 'image', baseUrl : blueConic.fn.getBCHostnameAwarePluginsRepositoryUrl(ps, pf) + 'image/1.0.3/'},{ id : 'number', baseUrl : blueConic.fn.getBCHostnameAwarePluginsRepositoryUrl(ps, pf) + 'number/1.0.2/'},{ id : 'string', baseUrl : blueConic.fn.getBCHostnameAwarePluginsRepositoryUrl(ps, pf) + 'string/1.0.1/'}]);})();(function(){ var InteractionTypeImpl=InteractionType.extend({init:function(e,t){this.blueConicClient=e,this.context=t},getPreloadProperties:function(){var e=this.context.getParameters(),t=e.responseProperty?e.responseProperty[0]:e.responseProperty;return t?(this.campaignIdentifierProperty=t,[t]):(this.campaignIdentifierProperty="responded_to_campaigns",["responded_to_campaigns"])},onLoad:function(){var e=this.context.getProfile(),t=this.context.getParameters(),r=this.blueConicClient,n=!1,i=!1,o=t.config?t.config[0]:t.config;if(o){for(var a=this.blueConicClient.json.parse(o),c=0;c<a.length;c++){var p=a[c],l=this.getParameterByName(p.parameter);l&&p.profileProperty&&(e.addValue(p.profileProperty,l),n=!0,p.isCampaignIdentifier&&!i&&(this._bindHandlers(l),i=!0))}n&&r.profile.updateProfile()}},_bindHandlers:function(e){var t=this,r=this.context.getProfile(),n=this.blueConicClient,i=document.querySelectorAll("a");Array.prototype.forEach.call(i,(function(i){i.addEventListener("click",(function(){r.addValue(t.campaignIdentifierProperty,e),n.profile.updateProfile()}))}));i=document.querySelectorAll("form");Array.prototype.forEach.call(i,(function(i){i.addEventListener("submit",(function(){r.addValue(t.campaignIdentifierProperty,e),n.profile.updateProfile()}))}))},getParameterByName:function(e){if(!e)return"";e=e.replace(/[[]/,"\\[").replace(/[\]]/,"\\]");var t=new RegExp("[\\?&#]"+e+"=([^&#]*)").exec(this.getLocationHref());return null===t?"":decodeURIComponent(t[1].replace(/\+/g," "))},getLocationHref:function(){return window.location.href}});var a = [];var i='listener_campaign_tracker';blueConic.fn.registerInteractionType(i, InteractionTypeImpl, a, [{ id : i, baseUrl : blueConic.fn.getBCHostnameAwarePluginsRepositoryUrl(ps, pf) + i + '/1.1.0/'}]);})();(function(){ var InteractionTypeImpl=InteractionType.extend({PARAMETERS:{ENGAGEMENT_PROPERTY:"engagementProperty",ENGAGEMENT_SCORE_PROPERTY:"engagementScoreProperty",DECAY:"decay",ENGAGEMENT_ON_CHANNEL:"engagementOnChannel"},DEFAULTS:{ENGAGEMENT:"engagement",ENGAGEMENT_SCORE:"engagement_score",VISITS:"visits",CLICKCOUNT:"clickcount"},SCORES:{LOW:"low",MEDIUM:"medium",HIGH:"high"},DEFAULT_DECAY:50,init:function(e,t){this.blueConicClient=e,this.context=t,this.parameters=t.getParameters(),this._channelId=e.getChannelId();var i="true"===this.getParameterValue(this.PARAMETERS.ENGAGEMENT_ON_CHANNEL)&&this._channelId;this.properties={engagement:this.getParameterValue(this.PARAMETERS.ENGAGEMENT_PROPERTY,this.DEFAULTS.ENGAGEMENT),engagementScore:this.getParameterValue(this.PARAMETERS.ENGAGEMENT_SCORE_PROPERTY,this.DEFAULTS.ENGAGEMENT_SCORE),engagementObject:"_"+this.getParameterValue(this.PARAMETERS.ENGAGEMENT_PROPERTY,this.DEFAULTS.ENGAGEMENT),visits:this.DEFAULTS.VISITS+(i?"_"+this._channelId:""),clickcount:this.DEFAULTS.CLICKCOUNT+(i?"_"+this._channelId:"")};var r=new Date(2015,0,1,0,0,0,0),n=(new Date).getTime()-r.getTime();this.days=Math.floor(n/864e5),this.weekNr=Math.floor(this.days/7),this.decay=parseInt(this.getParameterValue(this.PARAMETERS.DECAY))||this.DEFAULT_DECAY},getPreloadProperties:function(){return[this.properties.engagementObject,this.properties.visits,this.properties.clickcount]},onLoad:function(){var e=this.context.getProfile(),t=e.getValue(this.properties.clickcount)?parseInt(e.getValue(this.properties.clickcount)):0,i=e.getValue(this.properties.visits)?parseInt(e.getValue(this.properties.visits)):0,r=e.getValues(this.properties.engagementObject).map(function(e){return this.blueConicClient.json.parse(e)||{}}.bind(this)),n=this._clearInvalidValues(r,i),s=n.cleanedValues,a=this._sumInternalValues(s),h=this._addCurrentWeek(a,t,i),o=this._getCalculated(a,i,t),c=this._calculateScore(o);isNaN(c)||((h||s.length>1||n.removedValues)&&e.setValue(this.properties.engagementObject,JSON.stringify(a)),this._setEngagement(e,c))},getParameterValue:function(e,t){return this.parameters&&this.parameters[e]&&this.parameters[e][0]?this.parameters[e][0]:t},_clearInvalidValues:function(e,t){var i=!1;return e.forEach(function(e){var r=Object.keys(e).filter(function(e){return-1!==e.indexOf("v")}).map(function(e){return parseInt(e.substring(1))});r.sort(function(e,t){return t-e}),r.forEach(function(r){(i||e["v"+r]>t||e["v"+r]<0)&&(delete e["v"+r],delete e["c"+r],i=!0)})},this),{removedValues:i,cleanedValues:e}},_sumInternalValues:function(e){var t={};return e.forEach(function(e){Object.keys(e).forEach(function(i){t[i]=(t[i]||0)+e[i]})}),t},_setEngagement:function(e,t){var i=this.context.getParameters(),r=parseInt(i.lowTreshold?i.lowTreshold[0]:i.lowTreshold),n=parseInt(i.highTreshold?i.highTreshold[0]:i.highTreshold),s=this.SCORES.MEDIUM;t<r?s=this.SCORES.LOW:t>n&&(s=this.SCORES.HIGH),e.setValue(this.properties.engagementScore,t),e.setValue(this.properties.engagement,s),this.blueConicClient.profile.updateProfile()},_addCurrentWeek:function(e,t,i){var r=!1;return e["v"+this.weekNr]||(e["v"+this.weekNr]=i,r=!0),e["c"+this.weekNr]||(e["c"+this.weekNr]=t,r=!0),r},_calculateScore:function(e){for(var t=0,i=0;i<e.length;i++){var r=this._getWeight(i+1,this.decay),n=e[i];t+=(n.clickCount+5*n.visits)*r}return t=Math.floor(t)},_getWeight:function(e,t){return e<=.1*t?1:e<=.2*t?.8:e<=.4*t?.5:e<=t?.3:.1},_getCalculated:function(e,t,i){for(var r=[],n=this.weekNr;n>0;n--){var s=0;e["v"+n]&&(t-=s=Math.max(t-e["v"+n],0));var a=0;e["c"+n]&&(i-=a=Math.max(i-e["c"+n],0)),r.push({week:n,visits:s,clickCount:a})}return r}});var a = [];var i='listener_engagement';blueConic.fn.registerInteractionType(i, InteractionTypeImpl, a, [{ id : i, baseUrl : blueConic.fn.getBCHostnameAwarePluginsRepositoryUrl(ps, pf) + i + '/1.1.0/'}]);})();(function(){ var InteractionTypeImpl=InteractionType.extend({init:function(n,t){this.blueConicClient=n,this.context=t},getPreloadProperties:function(){return[]},onLoad:function(){}});var a = [];var i='listener_geolocation';blueConic.fn.registerInteractionType(i, InteractionTypeImpl, a, [{ id : i, baseUrl : blueConic.fn.getBCHostnameAwarePluginsRepositoryUrl(ps, pf) + i + '/1.1.1/'}]);})();(function(){ var InteractionTypeImpl=InteractionType.extend({init:function(a,b){this.blueConicClient=a,this.context=b;var c=new Date(2017,8,1,0,0,0,0),d=this.blueConicClient.getCurrentDate().getTime(),e=d-c.getTime();this.days=Math.floor(e/86400000)},getPreloadProperties:function(){return[]},onLoad:function(){var a=this.context.getProfile(),b=this.context.getParameters(),c=b.property?b.property[0]:b.property;if(c){var d=this.blueConicClient.json.parse(c)[0].profileproperty,e=this.blueConicClient.getCurrentDate(),f=this._getTimeFrame(e.getHours(),b.locale[0]),g={TIME:new Date().getTime(),data:[]};g.data.push({n:f,p:1,d:this.days}),a.addValue("_hl_"+d,this.blueConicClient.json.stringify(g)),this.blueConicClient.profile.updateProfile()}},_getTimeFrame:function(a,b){return this._getHour(a,b)+" - "+this._getHour(a+1,b)},_getHour:function(a,b){if("en-us"===b){var c=12<=a?"PM":"AM";return a%=12,a=0===a?12:a,a+" "+c}return a=10>a?"0"+a:a,a+":00"}});var a = [];var i='listener_preferred_hour';blueConic.fn.registerInteractionType(i, InteractionTypeImpl, a, [{ id : i, baseUrl : blueConic.fn.getBCHostnameAwarePluginsRepositoryUrl(ps, pf) + i + '/1.2.7/'}]);})();(function(){ var InteractionTypeImpl=InteractionType.extend({init:function(t,e){this.blueConicClient=t,this.profile=e.getProfile(),this.profileId=e.getProfile().getId();var i=e.getParameters();if(i.connectionId&&i.connectionId[0]){var r=e.getConnection(i.connectionId[0]);if(r){var o=r.getParameters();o.storeId&&o.storeId[0]&&(this.storeId=o.storeId[0]),o.metadata&&o.metadata[0]&&(this.metadata=o.metadata[0])}}i.addToCartSelector&&i.addToCartSelector[0]&&(this.addToCartSelector=i.addToCartSelector[0]),i.orderURL&&i.orderURL[0]&&(this.orderURLRegExp=new RegExp(".*"+i.orderURL[0]+".*"))},getPreloadProperties:function(){var t=[];return this.storeId&&(this.itemsProperty="_items_shoppingcart_"+this.storeId,t.push(this.itemsProperty)),t},_getItemIds:function(){return this.profile.getValues(this.itemsProperty)},_setItemIds:function(t){this.profile.setValues(this.itemsProperty,t),this.blueConicClient.profile.updateProfile()},addToCart:function(t){var e=this._getItemIds();e.push(t),this._setItemIds(e),this._handleAction("shoppingcart",e)},clearCart:function(){this._setItemIds([])},order:function(){var t=this._getItemIds();this._handleAction("order",t),this.clearCart()},_handleAction:function(t,e){var i={storeId:this.storeId,itemId:e,action:t,profileId:this.profileId};this.blueConicClient.recommendation.createEvent(i)},_bindAddToCartClickHandler:function(){var t=function(e){if(-1!==Array.prototype.indexOf.call(document.querySelectorAll(this.addToCartSelector),e.target)){var i=this.metaDataService.getItemId(document.location.href);i&&(this.addToCart(i),document.removeEventListener("click",t,!0))}}.bind(this);document.addEventListener("click",t,!0)},_checkOrderURL:function(){this.orderURLRegExp&&this.orderURLRegExp.test(document.location.href)&&this.order()},_onURLChange:function(){if(this.addToCartSelector&&this.storeId&&this.metadata){var t=JSON.parse(this.metadata);this.metaDataService=new this.BlueConicMetaDataService(this.jQuery,t,"product",document.location.href),this.metaDataService.blueConicClient=this.blueConicClient,document.querySelectorAll(this.addToCartSelector).length>0?this._bindAddToCartClickHandler():this.blueConicClient.position.subscribe(this.addToCartSelector,this,this._bindAddToCartClickHandler.bind(this))}this._checkOrderURL()},onLoad:function(){this._onURLChange(),this.blueConicClient.event.subscribe(this.blueConicClient.event.onUrlChange,this,(function(){this._onURLChange()}))}});var a = [];var i='listener_product_behavior';a.push({url: blueConic.fn.getBCHostnameAwarePluginsRepositoryUrl(ps, pf) + i + '/1.2.0/frontend/src/node_modules/@blueconic/jquery-x-jquerymigrate/load_jQuery3_7_X_jQueryMigrate.min.js', sharing: 'local'});a.push({url: blueConic.fn.getBCHostnameAwarePluginsRepositoryUrl(ps, pf) + i + '/1.2.0/frontend/src/node_modules/@blueconic/frontend-metadataservice/metaDataService.js', sharing: 'local'});blueConic.fn.registerInteractionType(i, InteractionTypeImpl, a, [{ id : i, baseUrl : blueConic.fn.getBCHostnameAwarePluginsRepositoryUrl(ps, pf) + i + '/1.2.0/'}]);})();(function(){ var InteractionTypeImpl=InteractionType.extend({init:function(a,b){this.blueConicClient=a,this.context=b;var c=new Date(2012,0,1,0,0,0,0),d=new Date,e=d.getTime()-c.getTime();this.days=Math.floor(e/86400000)},getPreloadProperties:function(){return[]},onLoad:function(){var a=this.context.getParameters(),b=a.config?a.config[0]:a.config;if(b){var c=this.blueConicClient.json.parse(b),d=document.location.href;(0<=d.indexOf("#")||0<=d.indexOf("?"))&&(d=d.substring(0,d.indexOf("#"))||d.substring(0,d.indexOf("?")));var e,f=d.split("/"),g=!1;for(e=0;e<c.length;e++){var h=c[e],i=f[e+3];h.checked&&h.profileProperty&&!g&&(this._storeEngagement(h.profileProperty,this._getValue(i)),i&&30<i.length&&h.checked&&(g=!0))}this.blueConicClient.profile.updateProfile()}},_getValue:function(a){return a?30<a.length?null:(0<=a.indexOf(".")&&(a=a.substring(0,a.indexOf("."))),isNaN(a)&&"index"!==a&&0!==a.indexOf("index.")?a:null):null},_storeEngagement:function(a,b){if(b){var c=this.context.getProfile(),d={TIME:new Date().getTime()};d[b]={},d[b]["p"+this.days]=1,c.addValue("_"+a,this.blueConicClient.json.stringify(d))}}});var a = [];var i='listener_url_structure';blueConic.fn.registerInteractionType(i, InteractionTypeImpl, a, [{ id : i, baseUrl : blueConic.fn.getBCHostnameAwarePluginsRepositoryUrl(ps, pf) + i + '/1.0.20/'}]);})();(function(){ var InteractionTypeImpl=InteractionType.extend({blueConicClient:null,context:null,_profile:null,_userLanguage:null,_systemLanguage:null,_language:null,_referrer:null,_hostName:null,_currentUrl:null,_domain:null,ORIGIN_TYPES:{WEB:"web",MOBILE_WEB:"mobile_web",CONNECTION:"connection",MOBILE:"mobile_app"},CONSTANTS:{THIRTY_MINUTES_IN_MS:18e5,UNKNOWN:""},PROFILE_PROPERTIES:{CLICKCOUNT:"clickcount",VISITS:"visits",VISITCLICKS:"visitclicks",LASTVISITDATE:"lastvisitdate",VISITEDSITES:"visitedsites",VISITEDDOMAIN:"visiteddomain",ENTRYPAGE:"entrypage",REFERRERHOST:"referrerhost",REFERRERHOSTS:"referrerhosts",HOSTENTRYPAGE:"hostentrypage",HOSTAVERAGETIME:"hostaveragetime",LASTREFERRERAVERAGE:"lastreferreraverage",AVERAGETIME:"averagetime",TOTALVISITTIME:"totalvisittime",RESOLUTION:"resolution",CURRENTRESOLUTION:"currentresolution",CURRENTSCREENWIDTH:"currentscreenwidth",CURRENTSCREENHEIGHT:"currentscreenheight",ORIGIN_TYPE:"origin_type",ORIGIN_SOURCE:"origin_source",ORIGIN_DETAIL:"origin_detail",DEVICETYPE:"devicetype",RECEIVED_FROM_SYSTEM:"received_from_system",RECEIVED_FROM_CONNECTION:"received_from_connection",MOBILE_APP_ID:"mobile_app_id",MOBILE_APP_NAMEVERSION:"mobile_app_nameversion",LANGUAGE:"language",KEYWORDS:"keywords",CURRENTKEYWORDS:"currentkeywords",CURRENT_UTM_SOURCE:"current_utm_source",CURRENT_UTM_MEDIUM:"current_utm_medium",CURRENT_UTM_TERM:"current_utm_term",CURRENT_UTM_CONTENT:"current_utm_content",CURRENT_UTM_CAMPAIGN:"current_utm_campaign",UTM_SOURCE:"utm_source",UTM_MEDIUM:"utm_medium",UTM_TERM:"utm_term",UTM_CONTENT:"utm_content",UTM_CAMPAIGN:"utm_campaign"},PROFILE_PROPERTIES_FOR_CHANNEL:{},init:function(e,t){this.blueConicClient=e,this.context=t,this._profile=e.profile.getProfile(),this._channelId=e.getChannelId(),this._referrer=document.referrer,this._hostName=window.location.hostname,this._currentUrl=window.location.href,this._domain=document.domain,this._userLanguage=window.navigator.userLanguage,this._systemLanguage=navigator.systemLanguage,this._language=window.navigator.language,this.PROFILE_PROPERTIES_FOR_CHANNEL={CLICKCOUNT:this.PROFILE_PROPERTIES.CLICKCOUNT+"_"+this._channelId,VISITS:this.PROFILE_PROPERTIES.VISITS+"_"+this._channelId,VISITCLICKS:this.PROFILE_PROPERTIES.VISITCLICKS+"_"+this._channelId,LASTVISITDATE:this.PROFILE_PROPERTIES.LASTVISITDATE+"_"+this._channelId}},onPrepare:function(){this._profile&&(this._setLanguageProperties(),this._setResolutionProperties(),this._setReferrerProperties(),this._setCampaignProperties())},onLoad:function(){this._profile&&(this._setReferrerHostOnLoad(),this._setVisitProperties(),this._setOriginProperties(),this.blueConicClient.profile.updateProfile())},getPreloadProperties:function(){return[this.PROFILE_PROPERTIES.CLICKCOUNT,this.PROFILE_PROPERTIES.VISITS,this.PROFILE_PROPERTIES.VISITCLICKS,this.PROFILE_PROPERTIES.LASTVISITDATE,this.PROFILE_PROPERTIES.VISITEDSITES,this.PROFILE_PROPERTIES.ENTRYPAGE,this.PROFILE_PROPERTIES.HOSTENTRYPAGE,this.PROFILE_PROPERTIES.HOSTAVERAGETIME,this.PROFILE_PROPERTIES.LASTREFERRERAVERAGE,this.PROFILE_PROPERTIES.AVERAGETIME,this.PROFILE_PROPERTIES.TOTALVISITTIME,this.PROFILE_PROPERTIES.RESOLUTION,this.PROFILE_PROPERTIES.DEVICETYPE,this.PROFILE_PROPERTIES.ORIGIN_TYPE,this.PROFILE_PROPERTIES.ORIGIN_SOURCE,this.PROFILE_PROPERTIES.ORIGIN_DETAIL,this.PROFILE_PROPERTIES.RECEIVED_FROM_SYSTEM,this.PROFILE_PROPERTIES.RECEIVED_FROM_CONNECTION,this.PROFILE_PROPERTIES.VISITEDDOMAIN,this.PROFILE_PROPERTIES.MOBILE_APP_ID,this.PROFILE_PROPERTIES.MOBILE_APP_NAMEVERSION,this.PROFILE_PROPERTIES_FOR_CHANNEL.CLICKCOUNT,this.PROFILE_PROPERTIES_FOR_CHANNEL.VISITS,this.PROFILE_PROPERTIES_FOR_CHANNEL.VISITCLICKS,this.PROFILE_PROPERTIES_FOR_CHANNEL.LASTVISITDATE]},_setLanguageProperties:function(){var e=this._userLanguage||this._systemLanguage||this._language,t=this._normalizeLocale(e).split("-")[0];t&&this._profile.setValue(this.PROFILE_PROPERTIES.LANGUAGE,t)},_normalizeLocale:function(e){return e&&e.replace("_","-").toLowerCase()},_setResolutionProperties:function(){var e=screen.width,t=screen.height;this._profile.setValue(this.PROFILE_PROPERTIES.CURRENTSCREENWIDTH,e),this._profile.setValue(this.PROFILE_PROPERTIES.CURRENTSCREENHEIGHT,t);var i=e+"x"+t;this._profile.setValue(this.PROFILE_PROPERTIES.CURRENTRESOLUTION,i),this._profile.addValue(this.PROFILE_PROPERTIES.RESOLUTION,i)},_setReferrerProperties:function(){this._setReferrerKeywords(),this._setReferrerHost()},_setReferrerKeywords:function(){var e=this.HELPER.decodeReferrer(this._referrer)||[];e.length>0&&(this._addProfileValues(this.PROFILE_PROPERTIES.KEYWORDS,e),this._profile.setValues(this.PROFILE_PROPERTIES.CURRENTKEYWORDS,e))},_addProfileValues:function(e,t){(Array.isArray(t)?t:[t]).forEach((function(t){this._profile.addValue(e,t)}),this)},_setReferrerHost:function(){var e=this._getReferrerHost();e!==this._hostName&&(this._profile.setValue(this.PROFILE_PROPERTIES.ENTRYPAGE,this._currentUrl),e&&(this._profile.setValue(this.PROFILE_PROPERTIES.REFERRERHOST,e),this._profile.addValue(this.PROFILE_PROPERTIES.REFERRERHOSTS,e)))},_setReferrerHostOnLoad:function(){var e=this._getReferrerHost();e!==this._hostName&&this._setHostEntryPageProperty(),this._setHostTotalAndAverageTimeProperty(this._hostName,e)},_getReferrerHost:function(){return this._referrer.replace(/http[s]?:\/\/(.*?)(:|\?|\/|$).*/,"$1")},_setCampaignProperties:function(){[this.PROFILE_PROPERTIES.UTM_SOURCE,this.PROFILE_PROPERTIES.UTM_MEDIUM,this.PROFILE_PROPERTIES.UTM_TERM,this.PROFILE_PROPERTIES.UTM_CONTENT,this.PROFILE_PROPERTIES.UTM_CAMPAIGN].forEach((function(e){var t=this._removeHashPart(this.HELPER._getParameterByName(this._currentUrl,e));t&&(this._profile.setValue("current_"+e,t),this._profile.addValue(e,t))}),this)},_setHostEntryPageProperty:function(){this._profile.setValue(this.PROFILE_PROPERTIES.ENTRYPAGE,this._currentUrl);var e=this._getHostEntryPageMapping();e[this._hostName]={entrypage:this._currentUrl},this._profile.setValue(this.PROFILE_PROPERTIES.HOSTENTRYPAGE,JSON.stringify(e))},_getHostEntryPageMapping:function(){return this._safeJSONParse(this._profile.getValue(this.PROFILE_PROPERTIES.HOSTENTRYPAGE))},_safeJSONParse:function(e){try{var t=e.replace(/'/g,'"');return JSON.parse(t)||{}}catch(i){return{}}},_setHostTotalAndAverageTimeProperty:function(e,t){var i=this._safeJSONParse(this._profile.getValue(this.PROFILE_PROPERTIES.HOSTAVERAGETIME));i[e]||(i[e]=this._createNewVisitData());var E=this.blueConicClient.getCurrentDate().getTime(),s=this._profile.getValue(this.PROFILE_PROPERTIES.LASTREFERRERAVERAGE),r=0,R=0,I=0;Object.keys(i).map((function(e){return e.toString()})).forEach((function(n){var _=i[n];this._isSessionExpired(_.enddate)?this._addVisit(_,_.enddate-_.startdate):n===e?_.enddate=E:n===t&&s!==t&&(_.enddate=E,this._profile.setValue(this.PROFILE_PROPERTIES.LASTREFERRERAVERAGE,t)),0!==_.averageTime&&(R++,r+=_.averageTime,I+=_.averageTime*_.visits)}),this),this._profile.setValue(this.PROFILE_PROPERTIES.HOSTAVERAGETIME,JSON.stringify(i)),this._profile.setValue(this.PROFILE_PROPERTIES.TOTALVISITTIME,I);var n=R>0?Math.round(r/R):0;this._profile.setValue(this.PROFILE_PROPERTIES.AVERAGETIME,n)},_addVisit:function(e,t){if(t>0){var i=e.averageTime*e.visits+t/1e3;e.visits++,e.averageTime=Math.round(i/e.visits)}var E=this.blueConicClient.getCurrentDate().getTime();e.startdate=E,e.enddate=E},_createNewVisitData:function(){var e=this.blueConicClient.getCurrentDate().getTime();return{startdate:e,enddate:e,averageTime:0,visits:0}},_setPropertyIfEmpty:function(e,t,i){"undefined"==typeof e[t]&&(e[t]=i)},_setVisitProperties:function(){this._addVisitedDomain(this._domain),this._increaseClickCount(),this._increaseVisits(this.PROFILE_PROPERTIES.VISITS,this.PROFILE_PROPERTIES.VISITCLICKS,this.PROFILE_PROPERTIES.LASTVISITDATE),this._channelId&&this._increaseVisits(this.PROFILE_PROPERTIES_FOR_CHANNEL.VISITS,this.PROFILE_PROPERTIES_FOR_CHANNEL.VISITCLICKS,this.PROFILE_PROPERTIES_FOR_CHANNEL.LASTVISITDATE)},_increaseVisits:function(e,t,i){e=e||this.PROFILE_PROPERTIES.VISITS,t=t||this.PROFILE_PROPERTIES.VISITCLICKS,i=i||this.PROFILE_PROPERTIES.LASTVISITDATE,this._isNewSession(e,i)?(this._resetPageViewsCurrentSession(t),this._increaseSessionCount(e)):this._increasePageViewsCurrentSession(t),this._setLastVisitDate(i,this.blueConicClient.getCurrentDate().getTime())},_setLastVisitDate:function(e,t){e=e||this.PROFILE_PROPERTIES.LASTVISITDATE,this._profile.setValue(e,t)},_addVisitedDomain:function(e){this._hasVisitedDomain(e)||this._profile.addValue(this.PROFILE_PROPERTIES.VISITEDSITES,e)},_hasVisitedDomain:function(e){var t=this._profile.getValues(this.PROFILE_PROPERTIES.VISITEDSITES)||[];return t.length>0&&-1!==t.indexOf(e)},_increaseClickCount:function(){this._profile.incrementValue(this.PROFILE_PROPERTIES.CLICKCOUNT,1),this._channelId&&this._profile.incrementValue(this.PROFILE_PROPERTIES_FOR_CHANNEL.CLICKCOUNT,1)},_isNewSession:function(e,t){e=e||this.PROFILE_PROPERTIES.VISITS,t=t||this.PROFILE_PROPERTIES.LASTVISITDATE;var i=this._getNumberProperty(e),E=this._getNumberProperty(t)||0;return 0===i||this._isSessionExpired(E)},_isSessionExpired:function(e){return this.blueConicClient.getCurrentDate().getTime()>e+this.CONSTANTS.THIRTY_MINUTES_IN_MS},_resetPageViewsCurrentSession:function(e){e=e||this.PROFILE_PROPERTIES.VISITCLICKS,this._profile.setValue(e,1)},_increasePageViewsCurrentSession:function(e){e=e||this.PROFILE_PROPERTIES.VISITCLICKS,this._profile.incrementValue(e,1)},_increaseSessionCount:function(e){e=e||this.PROFILE_PROPERTIES.VISITS,this._profile.incrementValue(e,1)},_setOriginProperties:function(){var e=this._getOriginCount();e>1?this._mergeOriginProperties():0===e&&this._resolveOriginProperties()},_getOriginCount:function(){var e=this._profile.getValues(this.PROFILE_PROPERTIES.ORIGIN_TYPE)||[],t=this._profile.getValues(this.PROFILE_PROPERTIES.ORIGIN_SOURCE)||[],i=this._profile.getValues(this.PROFILE_PROPERTIES.ORIGIN_DETAIL)||[];return Math.max(e.length,t.length,i.length)},_mergeOriginProperties:function(){this._mergePropertyToUnknown(this.PROFILE_PROPERTIES.ORIGIN_TYPE),this._mergePropertyToUnknown(this.PROFILE_PROPERTIES.ORIGIN_SOURCE),this._mergePropertyToUnknown(this.PROFILE_PROPERTIES.ORIGIN_DETAIL)},_mergePropertyToUnknown:function(e){var t=this._profile.getValues(e)||[];this._profile.setValue(e,1===t.length?t[0]:this.CONSTANTS.UNKNOWN)},_resolveOriginProperties:function(){this._isVisitorOriginFromWeb()?this._resolveOriginForWebVisitor():this._isVisitorOriginFromConnection()?this._resolveOriginForProfileComingFromConnection():this._isVisitorOriginFromMobileApp()&&this._resolveOriginForMobileAppVisitor()},_isVisitorOriginFromWeb:function(){var e=this._profile.getValues(this.PROFILE_PROPERTIES.RECEIVED_FROM_SYSTEM)||[],t=this._profile.getValues(this.PROFILE_PROPERTIES.MOBILE_APP_ID)||[];return 0===e.length&&0===t.length},_isVisitorOriginFromMobileApp:function(){var e=this._profile.getValues(this.PROFILE_PROPERTIES.RECEIVED_FROM_SYSTEM)||[],t=this._profile.getValues(this.PROFILE_PROPERTIES.MOBILE_APP_ID)||[],i=this._getNumberProperty(this.PROFILE_PROPERTIES.VISITS);return t.length>0&&0===e.length&&0===i},_isVisitorOriginFromConnection:function(){var e=this._profile.getValues(this.PROFILE_PROPERTIES.RECEIVED_FROM_SYSTEM),t=this._profile.getValues(this.PROFILE_PROPERTIES.MOBILE_APP_ID),i=this._getNumberProperty(this.PROFILE_PROPERTIES.VISITS);return e&&e.length>0&&t&&0===t.length&&i<=0},_resolveOriginForWebVisitor:function(){var e="",t=this._profile.getValues(this.PROFILE_PROPERTIES.VISITEDSITES)||[],i=this._profile.getValue(this.PROFILE_PROPERTIES.DEVICETYPE)||"",E=this._profile.getValues(this.PROFILE_PROPERTIES.ENTRYPAGE)||[];i&&(e="PC"===i?this.ORIGIN_TYPES.WEB:this.ORIGIN_TYPES.MOBILE_WEB);var s=1===t.length?t[0]:this.CONSTANTS.UNKNOWN,r=1===E.length?E[0]:this.CONSTANTS.UNKNOWN;this._setOriginProfileProperties(e,s,r)},_resolveOriginForProfileComingFromConnection:function(){var e=this._profile.getValues(this.PROFILE_PROPERTIES.RECEIVED_FROM_SYSTEM)||[],t=this._profile.getValues(this.PROFILE_PROPERTIES.RECEIVED_FROM_CONNECTION)||[],i=1===e.length?e[0]:this.CONSTANTS.UNKNOWN,E=1===t.length?t[0]:this.CONSTANTS.UNKNOWN;this._setOriginProfileProperties(this.ORIGIN_TYPES.CONNECTION,i,E)},_resolveOriginForMobileAppVisitor:function(){var e=this._profile.getValues(this.PROFILE_PROPERTIES.MOBILE_APP_ID)||[],t=this._profile.getValues(this.PROFILE_PROPERTIES.MOBILE_APP_NAMEVERSION)||[],i=1===e.length?e[0]:this.CONSTANTS.UNKNOWN,E=1===t.length?t[0]:this.CONSTANTS.UNKNOWN;this._setOriginProfileProperties(this.ORIGIN_TYPES.MOBILE,i,E)},_setOriginProfileProperties:function(e,t,i){this._profile.setValue(this.PROFILE_PROPERTIES.ORIGIN_TYPE,e),this._profile.setValue(this.PROFILE_PROPERTIES.ORIGIN_SOURCE,t),this._profile.setValue(this.PROFILE_PROPERTIES.ORIGIN_DETAIL,i)},_removeHashPart:function(e){if(e){var t=e.indexOf("#");if(-1!==t)return e.substring(0,t)}return e},HELPER:{search_engines:[["google\\.","q"],["bing\\.","q"],["search\\.yahoo\\.","p"],["search\\.aol\\.","q"],["duckduckgo\\.","q"],["baidu\\.","wd"],["ask\\.com","q"],["search\\.lycos\\.","q"],["dogpile\\.com","q"]],substringToHash:function(e){if(e){var t=e.indexOf("#");if(-1!==t)return e.substring(0,t)}return e},decodeReferrer:function(e){for(var t=new RegExp(""),i=0;i<this.search_engines.length;i++){var E=this.search_engines[i];t.compile("^http(s?)://(www\\.)?"+E[0],"i");var s=e.match(t);if(s){var r;if(r=isNaN(E[1])?this._getParameterByName(e,E[1]):s[E[1]+1])return r=decodeURIComponent(r),E.length>2&&E[2]&&(r=decodeURIComponent(r)),r=(r=(r=r.replace(/'|"/g,"")).split(/[\s,+.]+/)).filter((function(e){return e}));break}}return null},_getParameterByName:function(e,t){if(!t)return"";t=t.replace(/[[]/,"\\[").replace(/[\]]/,"\\]");var i=new RegExp("[\\?&#]"+t+"=([^&#]*)").exec(e);return null===i?"":decodeURIComponent(i[1].replace(/\+/g," "))}},_getNumberProperty:function(e){var t=this._profile.getValue(e);if(!t)return 0;try{t=parseInt(t),isNaN(t)&&(t=0)}catch(i){t=0}return t}});var a = [];var i='listenerinteractiontype';blueConic.fn.registerInteractionType(i, InteractionTypeImpl, a, [{ id : i, baseUrl : blueConic.fn.getBCHostnameAwarePluginsRepositoryUrl(ps, pf) + i + '/1.3.4/'}]);})();(function(){ var InteractionTypeImpl=InteractionType.extend({init:function(a,b){this.blueConicClient=a,this.context=b,this.parameters=b.getParameters(),this.profile=this.blueConicClient.profile.getProfile(),this.amountProcessedDataLayerEntries=0},onLoad:function(){let a=setInterval(()=>{let b;try{b=this._retrievePurchaseData()}catch(a){}if(b){window.clearInterval(a);try{let a=this._createTimelineEventObject(b);this._publishTimelineEvent(a)}catch(a){}}},1e3)},_retrievePurchaseData:function(){let a=window.dataLayer||[],b=a.slice(this.amountProcessedDataLayerEntries);this.amountProcessedDataLayerEntries+=b.length;for(let a of b)if(a&&a.ecommerce&&a.ecommerce.purchase)return a.ecommerce.purchase},_createTimelineEventObject:function(a){let b=[],c=0,d={};if(a){if(a.products)for(let d of a.products){let a=this._parseNumber(d.quantity);b.push({quantity:a,product_price:this._parseFloat(d.price),product_name:d.name,product_id:d.id,product_category:d.category,product_brand:d.brand,product_country:"",product_url:""}),c+=a}a.actionField&&(d.total_quantity=c,d.transaction_id=a.actionField.id)}if(0<b.length){let a=this._retrieveWebsiteContext();return d.label=a.label,d.customer_country=a.country,d.language=a.language,d.currency=a.currency,d.channel=a.channel,d.products=b,d.products[0].product_url=a.product_url,d.products[0].product_image=a.product_image,d.products[0].product_country=a.product_country,d.order_delivery_method=a.order_delivery_method,this._publishProductCollectorEvent(b),d}},_publishProductCollectorEvent:function(a){let b=[];for(let c of a)b.push(c.product_id);this.blueConicClient.event.publish("order",{productIds:b})},_publishTimelineEvent:function(a){if(a){let b=new Date;this.profile.timeline.createEvent("purchase",b,a);let c=this.parameters.datetimeProperty?this.parameters.datetimeProperty[0]:null,d=this.parameters.orderCountProperty?this.parameters.orderCountProperty[0]:null,e=!1;c&&(e=!0,this.profile.setValue(c,b)),d&&(e=!0,this.profile.incrementValue(d,1)),e&&this.blueConicClient.profile.updateProfile()}},_retrieveWebsiteContext:function(){let a={label:"-",customer_country:"-",language:"-",currency:"eur",channel:"web",product_url:"-",product_image:"-",product_country:"-",order_delivery_method:"-"};try{let b=document.location.host;0<=b.indexOf("guthaben")?(a.label="guthaben.de",a.language="de"):0<=b.indexOf("beltegoed")?(a.label="beltegoed.nl",a.language="nl"):0<=b.indexOf("mobiletopup")?(a.label="mobiletopup.co.uk",a.language="en",a.currency="gbp"):0<=b.indexOf("recharge.fr")?(a.label="recharge.fr",a.language="fr"):0<=b.indexOf("recharge.com")?(a.label="recharge.com",a.language="en"):0<=b.indexOf("herladen.com")&&(a.label="herladen.com",a.language="nl");let c=window.dataLayer||[];for(let b of c)b&&b.event&&"BC_PlatformInfo"===b.event&&(a.label=b.label?b.label.toLowerCase():a.label,a.channel=b.channel_type?b.channel_type:"web",a.product_image=b.product_image?b.product_image:this._retrieveImage(),a.product_url=b.product_url?b.product_url:a.product_url),b&&b.event&&"page"===b.event&&(a.language=b.app_language?b.app_language.toLowerCase():a.language,a.product_country=b.product_country?b.product_country.toLowerCase():"-",a.customer_country=b.customer_country?b.customer_country.toLowerCase():"-",a.currency=b.purchase_currency?b.purchase_currency.toLowerCase():"eur",a.order_delivery_method=b.order_delivery_method?b.order_delivery_method.toLowerCase():"pin")}catch(a){}return a},_retrieveImage:function(){try{let a=this.parameters.imageSelector?this.parameters.imageSelector[0]:"";if(a){let b=document.querySelector(a);if(b)return b.getAttribute("src")}}catch(a){}return""},_parseNumber:function(a){try{return parseInt(a)}catch(a){}return 0},_parseFloat:function(a){try{return parseFloat(a)}catch(a){}return 0}});var a = [];var i='purchase_event_listener_v1_5';blueConic.fn.registerInteractionType(i, InteractionTypeImpl, a, [{ id : i, baseUrl : blueConic.fn.getBCHostnameAwareLocalPluginsUrl() + '/plugins/purchase_event_listener_v1_5/ts_e7b24310dd092155709e99c1cd7ae502/'}]);})();(function(){ var InteractionTypeImpl=InteractionType.extend({init:function(a,b){this.blueConicClient=a,this.context=b},onLoad:function(){if(!window.bcPushStateListenerActive){window.bcPushStateListenerActive=!0,this.bcCurrentChannelIdentifier=window.bcChannelIdentifier;var a=this;window.addEventListener('popstate',function(){setTimeout(()=>{a._triggerPageView()},500)}),window.history&&window.history.pushState&&(window.history.pushState=function(a,b){return function(){setTimeout(()=>{b._triggerPageView()},250),a.apply(this,arguments)}}(window.history.pushState,this))}},_triggerPageView:function(){window.bcChannelIdentifier&&window.bcChannelIdentifier!==this.bcCurrentChannelIdentifier&&(this.bcCurrentChannelIdentifier=window.bcChannelIdentifier,this.blueConicClient.setChannelIdentifier(this.bcCurrentChannelIdentifier));var a;this._browserIsIE()?(a=document.createEvent('Event'),a.initEvent('bcBeforeHandlePageView',!1,!0)):a=new Event('bcBeforeHandlePageView'),window.dispatchEvent(a),this.blueConicClient.handlePageView()},_browserIsIE:function(){var a=window.navigator.userAgent,b=a.indexOf('MSIE ');return!(!(0<b)&&!navigator.userAgent.match(/Trident.*rv:11\./))}});var a = [];var i='pushstate_listener';blueConic.fn.registerInteractionType(i, InteractionTypeImpl, a, [{ id : i, baseUrl : blueConic.fn.getBCHostnameAwareLocalPluginsUrl() + '/plugins/pushstate_listener/ts_1ab43f9c41805d1a01a56e0b5f5476a2/'}]);})();(function(){ var InteractionTypeImpl=InteractionType.extend({init:function(a,b){this.blueConicClient=a,this.profile=a.profile.getProfile(),this.context=b,this.parameters=b.getParameters(),this.interactionId=b.getInteractionId(),this.dialogue_name=this.blueConicClient.getInteractionNamesById(this.interactionId).name,this.campaign_name=!!this.parameters.campaign_name&&this.parameters.campaign_name[0]},_fetchHTML:function(){let a=!!this.parameters.requestURL&&this.parameters.requestURL[0],b=this;try{const c=new URLSearchParams({CAMPAIGN_NAME:this.campaign_name,LOCATION:this.selectedElement.id,COUNTRY:this.selectedElement.getAttribute('cdp-country')?this.selectedElement.getAttribute('cdp-country'):'',LABEL:this.selectedElement.getAttribute('cdp-label')?this.selectedElement.getAttribute('cdp-label'):'',LANGUAGE:this.selectedElement.getAttribute('cdp-language')?this.selectedElement.getAttribute('cdp-language'):'',PAGE_TYPE:this.selectedElement.getAttribute('cdp-page-type')?this.selectedElement.getAttribute('cdp-page-type'):'',CATEGORY:this.selectedElement.getAttribute('cdp-category')?this.selectedElement.getAttribute('cdp-category'):'',BRAND:this.selectedElement.getAttribute('cdp-brand')?this.selectedElement.getAttribute('cdp-brand'):'',PRODUCT_TYPE:this.selectedElement.getAttribute('cdp-product-type')?this.selectedElement.getAttribute('cdp-product-type'):''});this.sendFeedback('BC_InteractionRequest'),fetch(a,{method:'POST',headers:{"Content-Type":'application/x-www-form-urlencoded'},body:c}).then((a)=>a.json()).then((a)=>{b._replacePosition(a)})['catch']()}catch(a){}},sendFeedback:function(a){try{window.dataLayer=window.dataLayer||[],window.dataLayer.push({event:a,campaign_name:this.campaign_name,location:this.selectedElement.id,country:this.selectedElement.getAttribute('cdp-country')?this.selectedElement.getAttribute('cdp-country'):'',label:this.selectedElement.getAttribute('cdp-label')?this.selectedElement.getAttribute('cdp-label'):'',language:this.selectedElement.getAttribute('cdp-language')?this.selectedElement.getAttribute('cdp-language'):'',page_type:this.selectedElement.getAttribute('cdp-page-type')?this.selectedElement.getAttribute('cdp-page-type'):'',category:this.selectedElement.getAttribute('cdp-category')?this.selectedElement.getAttribute('cdp-category'):'',brand:this.selectedElement.getAttribute('cdp-brand')?this.selectedElement.getAttribute('cdp-brand'):'',product_type:this.selectedElement.getAttribute('cdp-product-type')?this.selectedElement.getAttribute('cdp-product-type'):'',dialogue_name:this.dialogue_name,dialogue_id:this.context._dialogueId,variant_name:this.context._name,variant_id:this.interactionId})}catch(a){console.error('Unexpected error while sending dialogue to dataLayer: '+a)}},_replacePosition:function(a){var b=this;if(this.selectedElement&&a&&a.Body&&0<a.Body.length){this.selectedElement.innerHTML=a.Body,this._registerView(this.selectedElement);const c=this.selectedElement.querySelectorAll('a, button');c.forEach((a)=>{a.addEventListener('click',function(){b.blueConicClient.createEvent('CLICK',b.interactionId),b.sendFeedback('BC_InteractionClick')})})}},_isVisible:function(a){if(!(a instanceof Element))return!1;const b=getComputedStyle(a);if('none'===b.display)return!1;if('visible'!==b.visibility)return!1;if(.1>b.opacity)return!1;if(0===a.offsetWidth+a.offsetHeight+a.getBoundingClientRect().height+a.getBoundingClientRect().width)return!1;const c={x:a.getBoundingClientRect().left+a.offsetWidth/2,y:a.getBoundingClientRect().top+a.offsetHeight/2};if(0>c.x)return!1;if(c.x>(document.documentElement.clientWidth||window.innerWidth))return!1;if(0>c.y)return!1;if(c.y>(document.documentElement.clientHeight||window.innerHeight))return!1;let d=document.elementFromPoint(c.x,c.y);do{if(d===a)return!0;d=d.parentNode}while(d);return!1},_registerView:function(a){if(!this.blueConicClient.isInEditMode()){const b=this;this._registeredEvent=function(){b._checkVisibility(a)},window.addEventListener('resize',this._registeredEvent,!1),window.addEventListener('scroll',this._registeredEvent,!1),this._checkVisibility(a)}},_checkVisibility:function(a){if(!this._timeoutID){const b=new Date().getTime();if(this._lastCheckDate||(this._lastCheckDate=b),500<=b-this._lastCheckDate)this._lastCheckDate=b,this._isVisible(a)&&(!this._viewEventRegistered&&(this._viewEventRegistered=!0,this.blueConicClient.createEvent('VIEW',this.interactionId),this.sendFeedback('BC_InteractionView')),clearTimeout(this._timeoutID),window.removeEventListener('resize',this._registeredEvent,!1),window.removeEventListener('scroll',this._registeredEvent,!1));else{const b=this;this._timeoutID=setTimeout(function(){b._timeoutID=null,b._checkVisibility(a)},500)}}},onUpdate:function(){this.context&&(this.parameters=this.context.getParameters(),this._fetchHTML())},onLoad:function(){this.selectedElement=this.context.getDOMElement(),this.selectedElement?this._fetchHTML():console.log('Unable to place smart banner, element not available')}});var a = [];var i='smart_banner';blueConic.fn.registerInteractionType(i, InteractionTypeImpl, a, [{ id : i, baseUrl : blueConic.fn.getBCHostnameAwareLocalPluginsUrl() + '/plugins/smart_banner/ts_1fabfa381c3c65df1eb42f8e7c466b78/'},{ id : 'string', baseUrl : blueConic.fn.getBCHostnameAwarePluginsRepositoryUrl(ps, pf) + 'string/1.0.1/'}]);})();(function(){ var InteractionTypeImpl=InteractionType.extend({init:function(a,b){this.blueConicClient=a,this.context=b,this.parameters=b.getParameters(),this.profile=this.blueConicClient.profile.getProfile(),this.amountProcessedDataLayerEntries=0},onLoad:function(){let a=setInterval(()=>{let b;try{b=this._retrieveItemListData()}catch(a){}if(b){window.clearInterval(a);try{let a=this._createTimelineEventObject(b);this._publishTimelineEvent(a)}catch(a){}}},1e3)},_publishTimelineEvent:function(a){if(a){let b=new Date;this.profile.timeline.createEvent("view_item_list",b,a);let c=this.parameters.datetimeProperty?this.parameters.datetimeProperty[0]:null;c&&(this.profile.setValue(c,b),this.blueConicClient.profile.updateProfile())}},_createTimelineEventObject:function(a){let b={};a&&(b.label=a.label?a.label.toLowerCase():"-",b.channel_type=a.channel_type?a.channel_type:"web",b.product_image=a.product_image?a.product_image:"-",b.product_url=a.product_url?a.product_url:location.href);let c=this._retrieveWebsiteContext();if(b.customer_language=c.language,b.customer_country=c.customer_country,b.product_country=c.product_country,b.product_brand=c.product_brand,b.product_category=c.product_category,b.currency=c.currency,"brand"===c.page_type)return b},_retrieveItemListData:function(){let a=window.dataLayer||[],b=a.slice(this.amountProcessedDataLayerEntries);this.amountProcessedDataLayerEntries+=b.length;for(let a of b)if(a&&"BC_PlatformInfo"===a.event)return a},_retrieveWebsiteContext:function(){let a={language:"-",product_country:"-",product_brand:"-",product_category:"-",customer_country:"-",currency:"-",page_type:"-"};try{let b=window.dataLayer||[];for(let c of b)c&&c.event&&"page"===c.event&&(a.language=c.app_language?c.app_language.toLowerCase():"-",a.product_country=c.product_country?c.product_country.toLowerCase():"-",a.product_brand=c.product_brand?c.product_brand.toLowerCase():"-",a.product_category=c.product_category?c.product_category.toLowerCase():"-",a.customer_country=c.product_country?c.product_country.toLowerCase():"-",a.currency=c.purchase_currency?c.purchase_currency.toLowerCase():"eur",a.page_type=c.page_type?c.page_type.toLowerCase():"-");if("-"===a.language){let b=document.location.host;0<=b.indexOf("guthaben")?a.language="de":0<=b.indexOf("beltegoed")?a.language="nl":0<=b.indexOf("mobiletopup")?a.language="en":0<=b.indexOf("recharge.fr")?a.language="fr":0<=b.indexOf("recharge.com")?a.label="recharge":0<=b.indexOf("herladen.com")&&(a.language="nl")}}catch(a){}return a}});var a = [];var i='view_item_listener';blueConic.fn.registerInteractionType(i, InteractionTypeImpl, a, [{ id : i, baseUrl : blueConic.fn.getBCHostnameAwareLocalPluginsUrl() + '/plugins/view_item_listener/ts_30106c7fbc238a38a2db67b7345c4460/'}]);})();})(blueConicClient);